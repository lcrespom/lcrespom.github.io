{"version":3,"sources":["webpack:///webpack/bootstrap 7da55173da32d457d937","webpack:///./ts/main.ts","webpack:///./ts/graph.ts","webpack:///./ts/synth.ts","webpack:///./ts/paramsUI.ts"],"names":["SynthNode","SynthNode.constructor","SynthNode.addInput","SynthNode.removeInput","SynthNode.canBeSource","SynthNode.canConnectInput","main","registerNodeSelection","addOutputNode","registerPlayHandler","registerPlayHandler.togglePlayStop","registerPaletteHandler","setArrowColors","getCssFromClass","Graph","Graph.constructor","Graph.arrowColor","Graph.addNode","Graph.nodeSelected","Graph.draw","Node","Node.constructor","Node.addInput","Node.removeInput","Node.canBeSource","Node.canConnectInput","GraphInteraction","GraphInteraction.constructor","GraphInteraction.registerNode","GraphInteraction.setupConnectHandler","GraphInteraction.connectOrDisconnect","GraphInteraction.getElementUnderMouse","GraphInteraction.registerRubberBanding","GraphInteraction.deregisterRubberBanding","GraphInteraction.getNodeFromDOM","GraphDraw","GraphDraw.constructor","GraphDraw.draw","GraphDraw.clearCanvas","GraphDraw.drawArrow","GraphDraw.drawArrowTip","GraphDraw.getNodeCenter","Synth","Synth.constructor","Synth.createAudioNode","Synth.play","Synth.stop","renderParams","renderAudioParam","renderParamControl","renderOtherParam","renderCombo","logarithm","param2slider","slider2param","ucfirst","truncateFloat"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 7da55173da32d457d937\n **/","import { Graph, Node } from './graph';\nimport { Synth, NodeDef } from './synth';\nimport { renderParams } from './paramsUI';\n\n\nclass SynthNode extends Node {\n\tanode: ModernAudioNode;\n\ttype: string;\t//TODO with nodeDef, this is no longer required\n\tnodeDef: NodeDef;\n\t// Used by control nodes only\n\tcontrolParam: string;\n\tcontrolParams: string[];\n\tcontrolTarget: ModernAudioNode;\n\n\taddInput(n: SynthNode) {\n\t\tsuper.addInput(n);\n\t\tif (n.nodeDef.control && !this.nodeDef.control) {\n\t\t\tn.controlParams = Object.keys(this.nodeDef.params)\n\t\t\t\t.filter(pname => this.anode[pname] instanceof AudioParam); \n\t\t\tn.controlParam = n.controlParams[0];\n\t\t\tn.controlTarget = this.anode;\n\t\t\tn.anode.connect(this.anode[n.controlParam]);\n\t\t\t//TODO update params box in case selected node is n\n\t\t}\n\t\telse n.anode.connect(this.anode);\n\t}\n\n\tremoveInput(np: SynthNode | number): Node {\n\t\tconst removed: SynthNode = <SynthNode>super.removeInput(np);\n\t\tif (removed.nodeDef.control && !this.nodeDef.control) {\n\t\t\tremoved.controlParams = null;\n\t\t\tremoved.anode.disconnect(this.anode[removed.controlParam]);\n\t\t}\n\t\telse //TODO test fan-out\n\t\t\tremoved.anode.disconnect(this.anode);\n\t\treturn removed;\n\t}\n\n\tcanBeSource(): boolean {\n\t\treturn this.anode.numberOfOutputs > 0;\n\t}\n\n\tcanConnectInput(n: SynthNode): boolean {\n\t\tif (n.nodeDef.control) return true;\n\t\treturn this.anode.numberOfInputs > 0;\n\t}\n}\n\ninterface ModernAudioNode extends AudioNode {\n\tdisconnect(output?: number | AudioNode | AudioParam): void\n}\n\nconst gr = new Graph(<HTMLCanvasElement>$('#graph-canvas')[0]);\nconst synth = new Synth();\n\nmain();\n\nfunction main() {\n\tregisterNodeSelection();\n\tsetArrowColors();\n\tregisterPaletteHandler();\n\tregisterPlayHandler();\n\taddOutputNode();\n}\n\nfunction registerNodeSelection() {\n\tgr.nodeSelected = function(n: SynthNode) {\n\t\trenderParams(n, synth.palette[n.type], $('#node-params'));\n\t}\n}\n\nfunction addOutputNode() {\n\tconst out = new SynthNode(500, 180, 'Out');\n\tout.anode = synth.ac.destination;\n\tout.type = 'Speaker';\n\tgr.addNode(out);\n}\n\nfunction registerPlayHandler() {\n\tlet playing = false;\n\n\tconst $playBut = $('#play-stop');\n\t$playBut.click(togglePlayStop);\n\t$('body').keypress(evt => {\n\t\tif (evt.keyCode == 32)\n\t\t\ttogglePlayStop();\n\t});\n\n\tfunction togglePlayStop() {\n\t\tif (playing) {\n\t\t\tsynth.stop();\n\t\t\t$playBut.text('Play');\n\t\t}\n\t\telse {\n\t\t\tsynth.play();\n\t\t\t$playBut.text('Stop');\n\t\t}\n\t\tplaying = !playing;\n\t}\n\n}\n\nfunction registerPaletteHandler() {\n\t$('.palette > .node').click(function(evt) {\n\t\tconst elem = $(this);\n\t\tconst n = new SynthNode(260, 180, elem.text());\n\t\tn.type = elem.attr('data-type');\n\t\tn.anode = synth.createAudioNode(n.type);\n\t\tn.nodeDef = synth.palette[n.type];\n\t\tgr.addNode(n, n.nodeDef.control ? 'node-ctrl' : undefined);\n\t\tif (!n.anode) {\n\t\t\tconsole.warn(`No AudioNode found for '${n.type}'`);\n\t\t\tn.element.css('background-color', '#BBB');\n\t\t}\n\t\telse {\n\t\t\tif (n.anode['start']) n.anode['start']();\n\t\t}\n\t});\n}\n\nfunction setArrowColors() {\n\tconst arrowColor = getCssFromClass('arrow', 'color');\n\tconst ctrlArrowColor = getCssFromClass('arrow-ctrl', 'color');\n\tconst originalDrawArrow = gr.graphDraw.drawArrow;\n\tgr.graphDraw.drawArrow = function(srcNode: SynthNode, dstNode: SynthNode) {\n\t\tthis.arrowColor = srcNode.nodeDef.control ? ctrlArrowColor : arrowColor;\n\t\toriginalDrawArrow.bind(this)(srcNode, dstNode);\n\t}\n}\n\nfunction getCssFromClass(className, propName) {\t\n\tconst tmp = $('<div>').addClass(className);\n\t$('body').append(tmp);\n\tconst propValue = tmp.css(propName);\n\ttmp.remove();\n\treturn propValue;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/main.ts\n **/","export class Graph {\n\n\tnodeCanvas: JQuery;\n\tnodes: Node[] = [];\n\tgraphDraw: GraphDraw;\n\tgraphInteract: GraphInteraction;\n\n\tconstructor(canvas: HTMLCanvasElement) {\n\t\tthis.nodeCanvas = $(canvas.parentElement);\n\t\tconst gc = canvas.getContext('2d');\n\t\tthis.graphDraw = new GraphDraw(gc, canvas, this.nodes);\n\t\tthis.graphInteract = new GraphInteraction(this, gc);\n\t}\n\n\tset arrowColor(color: string) {\n\t\tthis.graphDraw.arrowColor = color;\n\t}\n\n\taddNode(n: Node, classes?:string) {\n\t\tn.element = $('<div>')\n\t\t\t.addClass('node')\n\t\t\t.text(n.name)\n\t\t\t.css({ left: n.x, top: n.y, cursor: 'default' });\n\t\tif (classes) n.element.addClass(classes);\n\t\tthis.nodeCanvas.append(n.element);\n\t\tthis.nodes.push(n);\n\t\tthis.graphInteract.registerNode(n);\n\t\tthis.draw();\n\t}\n\n\tnodeSelected(n: Node) {}\n\n\tdraw() {\n\t\tthis.graphDraw.draw();\n\t}\n\n}\n\n\nexport class Node {\n\tx: number;\n\ty: number;\n\tname: string;\n\tinputs: Node[] = [];\n\telement: JQuery;\n\tw: number;\n\th: number;\n\n\tconstructor(x: number, y: number, name: string) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.name = name;\n\t}\n\n\taddInput(n: Node) {\n\t\tthis.inputs.push(n);\n\t}\n\n\tremoveInput(np: Node | number): Node {\n\t\tlet pos: number;\n\t\tlet result: Node;\n\t\tif (np instanceof Node) {\n\t\t\tpos = this.inputs.indexOf(<Node>np);\n\t\t\tresult = np;\n\t\t}\n\t\telse {\n\t\t\tpos = <number>np;\n\t\t\tresult = this.inputs[pos];\n\t\t}\n\t\tif (np >= 0)\n\t\t\tthis.inputs.splice(<number>np, 1);\n\t\treturn result;\n\t}\n\n\tcanBeSource(): boolean {\n\t\treturn true;\n\t}\n\n\tcanConnectInput(n: Node): boolean {\n\t\treturn true;\n\t}\n\n}\n\n\n//------------------------- Privates -------------------------\n\nclass GraphInteraction {\n\n\tgraph: Graph;\n\tgc: CanvasRenderingContext2D;\n\tconnecting = false;\n\tdragging = false;\n\tselectedNode: Node;\n\n\tconstructor(graph: Graph, gc: CanvasRenderingContext2D) {\n\t\tthis.graph = graph;\n\t\tthis.gc = gc;\n\t\tthis.setupConnectHandler();\n\t}\n\n\tregisterNode(n: Node) {\n\t\tn.element.draggable({\n\t\t\tcontainment: 'parent',\n\t\t\tdistance: 5,\n\t\t\tstack: '.node',\n\t\t\tdrag: (event, ui) => {\n\t\t\t\tn.x = ui.position.left;\n\t\t\t\tn.y = ui.position.top;\n\t\t\t\tthis.graph.draw();\n\t\t\t},\n\t\t\tstart: (event, ui) => {\n\t\t\t\tthis.dragging = true;\n\t\t\t\tui.helper.css('cursor', 'move');\n\t\t\t},\n\t\t\tstop: (event, ui) => {\n\t\t\t\tui.helper.css('cursor', 'default');\n\t\t\t\tthis.dragging = false;\n\t\t\t}\n\t\t});\n\t\tn.element.click(_ => {\n\t\t\tif (this.dragging) return;\n\t\t\tif (this.selectedNode == n) return;\n\t\t\tif (this.selectedNode)\n\t\t\t\tthis.selectedNode.element.removeClass('selected');\n\t\t\tn.element.addClass('selected');\n\t\t\tthis.selectedNode = n;\n\t\t\tthis.graph.nodeSelected(n);\n\t\t});\n\t}\n\n\tsetupConnectHandler() {\n\t\tlet srcn: Node;\n\t\t$('body').keydown(evt => {\n\t\t\tif (evt.keyCode != 16  || this.connecting) return;\n\t\t\tsrcn = this.getNodeFromDOM(this.getElementUnderMouse());\n\t\t\tif (!srcn) return;\n\t\t\tif (!srcn.canBeSource()) {\n\t\t\t\tsrcn.element.css('cursor', 'not-allowed');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.graph.nodeCanvas.css('cursor', 'crosshair');\n\t\t\tthis.graph.nodeCanvas.find('.node').css('cursor', 'crosshair');\n\t\t\tthis.connecting = true;\n\t\t\tthis.registerRubberBanding(srcn);\n\t\t})\n\t\t.keyup(evt => {\n\t\t\tif (evt.keyCode != 16) return;\n\t\t\tthis.connecting = false;\n\t\t\tthis.graph.nodeCanvas.css('cursor', '');\n\t\t\tthis.graph.nodeCanvas.find('.node').css('cursor', 'default');\n\t\t\tthis.deregisterRubberBanding();\n\t\t\tconst dstn = this.getNodeFromDOM(this.getElementUnderMouse());\n\t\t\tif (!dstn) return;\n\t\t\tthis.connectOrDisconnect(srcn, dstn);\n\t\t\tthis.graph.draw();\n\t\t});\n\t}\n\n\tconnectOrDisconnect(srcn: Node, dstn: Node) {\n\t\tif (srcn == dstn) return;\t// duh!\n\t\tconst pos = dstn.inputs.indexOf(srcn);\n\t\tif (pos >= 0) dstn.removeInput(pos);\n\t\telse if (srcn.canBeSource() && dstn.canConnectInput(srcn))\n\t\t\tdstn.addInput(srcn);\n\t}\n\n\tgetElementUnderMouse(): JQuery {\n\t\tconst hovered = $(':hover');\n\t\tif (hovered.length <= 0) return null;\n\t\tconst jqNode = $(hovered.get(hovered.length - 1));\n\t\tif (!jqNode.hasClass('node')) return null;\n\t\treturn jqNode;\n\t}\n\n\tregisterRubberBanding(srcn: Node) {\n\t\tconst ofs = this.graph.nodeCanvas.offset();\n\t\tconst dstn = new Node(0, 0, '');\n\t\tdstn.w = 0;\n\t\tdstn.h = 0;\n\t\t$(this.graph.nodeCanvas).on('mousemove', evt => {\n\t\t\tdstn.x = evt.clientX - ofs.left;\n\t\t\tdstn.y = evt.clientY - ofs.top;\n\t\t\tthis.graph.draw();\n\t\t\tthis.gc.save();\n\t\t\tthis.gc.setLineDash([10]);\n\t\t\tthis.graph.graphDraw.drawArrow(srcn, dstn);\n\t\t\tthis.gc.restore();\n\t\t});\n\t\tfor (const n of this.graph.nodes)\n\t\t\tif (n != srcn && !n.canConnectInput(srcn))\n\t\t\t\tn.element.css('cursor', 'not-allowed');\n\t}\n\n\tderegisterRubberBanding() {\n\t\tthis.graph.nodeCanvas.off('mousemove');\n\t\tthis.graph.graphDraw.draw();\n\t}\n\n\tgetNodeFromDOM(jqNode: JQuery) {\n\t\tif (!jqNode) return null;\n\t\tfor (const n of this.graph.nodes)\n\t\t\tif (n.element[0] == jqNode[0]) return n;\n\t\treturn null;\n\t}\n}\n\n\ninterface Point {\n\tx: number,\n\ty: number\n}\n\n\nclass GraphDraw {\n\n\tgc: CanvasRenderingContext2D;\n\tcanvas: HTMLCanvasElement;\n\tarrowColor: string = \"black\";\n\tarrowHeadLen = 10;\n\tnodes: Node[];\n\n\tconstructor(gc: CanvasRenderingContext2D, canvas: HTMLCanvasElement, nodes: Node[]) {\n\t\tthis.gc = gc;\n\t\tthis.canvas = canvas;\n\t\tthis.nodes = nodes;\n\t}\n\n\tdraw() {\n\t\tthis.clearCanvas();\n\t\tthis.gc.lineWidth = 2;\n\t\tfor (const ndst of this.nodes)\n\t\t\tfor (const nsrc of ndst.inputs)\n\t\t\t\tthis.drawArrow(nsrc, ndst);\n\t}\n\n\tclearCanvas() {\n\t\tthis.gc.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t}\n\n\tdrawArrow(srcNode: Node, dstNode: Node) {\n\t\tconst srcPoint = this.getNodeCenter(srcNode);\n\t\tconst dstPoint = this.getNodeCenter(dstNode);\n\t\tthis.gc.strokeStyle = this.arrowColor;\n\t\tthis.gc.beginPath();\n\t\tthis.gc.moveTo(srcPoint.x, srcPoint.y);\n\t\tthis.gc.lineTo(dstPoint.x, dstPoint.y);\n\t\tthis.drawArrowTip(srcPoint, dstPoint);\n\t\tthis.gc.closePath();\n\t\tthis.gc.stroke();\n\t}\n\n\tdrawArrowTip(src: Point, dst: Point) {\n\t\tconst posCoef = 0.6;\n\t\tconst mx = src.x + (dst.x - src.x) * posCoef;\n\t\tconst my = src.y + (dst.y - src.y) * posCoef;\n\t\tvar angle = Math.atan2(dst.y - src.y, dst.x - src.x);\n\t\tthis.gc.moveTo(mx, my);\n\t\tthis.gc.lineTo(\n\t\t\tmx - this.arrowHeadLen * Math.cos(angle - Math.PI/6),\n\t\t\tmy - this.arrowHeadLen * Math.sin(angle - Math.PI/6)\n\t\t);\n\t\tthis.gc.moveTo(mx, my);\n\t\tthis.gc.lineTo(\n\t\t\tmx - this.arrowHeadLen * Math.cos(angle + Math.PI/6),\n\t\t\tmy - this.arrowHeadLen * Math.sin(angle + Math.PI/6)\n\t\t);\n\t}\n\n\tgetNodeCenter(n: Node): Point {\n\t\tn.w = n.w !== undefined ? n.w : n.element.outerWidth();\n\t\tn.h = n.h !== undefined ? n.h : n.element.outerHeight();\n\t\treturn { x: n.x + n.w / 2, y: n.y + n.h / 2 };\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/graph.ts\n **/","export class Synth {\n\tac: ModernAudioContext;\n\tpalette: NodePalette;\n\n\tconstructor() {\n\t\tconst CtxClass: any = window.AudioContext || window.webkitAudioContext;\n\t\tthis.ac = new CtxClass();\n\t\tthis.stop();\n\t\tthis.palette = palette;\n\t}\n\n\tcreateAudioNode(type: string): AudioNode {\n\t\tconst def: NodeDef = palette[type];\n\t\tif (!def || !this.ac[def.constructor]) return null;\n\t\tconst anode = this.ac[def.constructor]();\n\t\tfor (const param of Object.keys(def.params || {}))\n\t\t\tif (!anode[param])\n\t\t\t\tconsole.warn(`Parameter '${param}' not found for node ${type}'`)\n\t\t\telse if (anode[param] instanceof AudioParam)\n\t\t\t\tanode[param].value = def.params[param].initial;\n\t\t\telse\n\t\t\t\tanode[param] = def.params[param].initial;\n\t\treturn anode;\n\t}\n\n\tplay() {\n\t\tthis.ac.resume();\n\t}\n\n\tstop() {\n\t\tthis.ac.suspend();\n\t}\n}\n\nexport interface NodePalette {\n\t[key: string]: NodeDef\n}\n\nexport interface NodeDef {\n\tconstructor: string,\n\tcontrol?: boolean,\n\tparams: { [key: string]: NodeParamDef }\n}\n\nexport interface NodeParamDef {\n\tinitial: number | string,\n\tmin?: number,\n\tmax?: number,\n\tlinear?: boolean,\n\tchoices?: string[]\n}\n\n//-------------------- Node palette definition --------------------\n\nconst OCTAVE_DETUNE: NodeParamDef = {\n\tinitial: 0,\n\tmin: -1200,\n\tmax: 1200,\n\tlinear: true\n};\n\nconst FREQUENCY: NodeParamDef = {\n\tinitial: 220,\n\tmin: 20,\n\tmax: 20000\n};\n\nvar palette: NodePalette = {\n\t// Sources\n\tOscillator: {\n\t\tconstructor: 'createOscillator',\n\t\tparams: {\n\t\t\tfrequency: FREQUENCY,\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sawtooth',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\t// Effects\n\tGain: {\n\t\tconstructor: 'createGain',\n\t\tparams: {\n\t\t\tgain: {\n\t\t\t\tinitial: 1,\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 10,\n\t\t\t\tlinear: true\n\t\t\t}\n\t\t}\n\t},\n\tFilter: {\n\t\tconstructor: 'createBiquadFilter',\n\t\tparams: {\n\t\t\tfrequency: FREQUENCY,\n\t\t\tQ: {\n\t\t\t\tinitial: 0,\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 100\n\t\t\t},\n\t\t\t//TODO gain\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'lowpass',\n\t\t\t\tchoices: ['lowpass', 'highpass', 'bandpass',\n\t\t\t\t\t'lowshelf', 'highshelf', 'peaking', 'notch', 'allpass']\n\t\t\t}\n\t\t},\n\t},\n\tDelay: {\n\t\tconstructor: 'createDelay',\n\t\tparams: {\n\t\t\tdelayTime: {\n\t\t\t\tinitial: 1,\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 5\n\t\t\t}\n\t\t}\n\t},\n\t// Controllers\n\tLFO: {\n\t\tconstructor: 'createOscillator',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tfrequency: {\n\t\t\t\tinitial: 2,\n\t\t\t\tmin: 0.01,\n\t\t\t\tmax: 200\n\t\t\t},\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sine',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tGainCtrl: {\n\t\tconstructor: 'createGain',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tgain: {\n\t\t\t\tinitial: 10,\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1000,\n\t\t\t\tlinear: true\n\t\t\t}\n\t\t}\n\t},\n\t// Output\n\tSpeaker: {\n\t\tconstructor: null,\n\t\tparams: null\n\t}\n};\n\n\n//-------------------- Internal interfaces --------------------\n\ninterface ModernWindow extends Window {\n\tAudioContext: AudioContext,\n\twebkitAudioContext: AudioContext\n}\ndeclare var window: ModernWindow;\n\ninterface ModernAudioContext extends AudioContext {\n\tsuspend: () => void,\n\tresume: () => void,\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth.ts\n **/","import { Node } from './graph';\nimport { NodeDef, NodeParamDef } from './synth';\n\n//TODO refactor main so \"n\" can be typed to SynthNode\nexport function renderParams(n: any, ndef: NodeDef, panel: JQuery) {\n\tpanel.empty();\n\tif (ndef.control)\n\t\trenderParamControl(n, panel);\n\tfor (const param of Object.keys(ndef.params || {}))\n\t\tif (n.anode[param] instanceof AudioParam)\n\t\t\trenderAudioParam(n.anode, ndef, param, panel);\n\t\telse\n\t\t\trenderOtherParam(n.anode, ndef, param, panel);\n}\n\nfunction renderAudioParam(anode: AudioNode, ndef: NodeDef, param: string, panel: JQuery) {\n\tconst pdef: NodeParamDef = ndef.params[param];\n\tconst aparam: AudioParam = anode[param];\n\tconst sliderBox = $('<div class=\"slider-box\">');\n\tconst slider = $('<input type=\"range\" orient=\"vertical\">')\n\t\t.attr('min', 0)\n\t\t.attr('max', 1)\n\t\t.attr('step', 0.001)\n\t\t.attr('value', param2slider(aparam.value, pdef))\n\tconst numInput = $('<input type=\"number\">')\n\t\t.attr('min', pdef.min)\n\t\t.attr('max', pdef.max)\n\t\t.attr('value', aparam.value);\n\tsliderBox.append(numInput);\n\tsliderBox.append(slider);\n\tsliderBox.append($('<span><br/>' + ucfirst(param) + '</span>'));\n\tpanel.append(sliderBox);\n\tslider.on('input', _ => {\n\t\tconst value = slider2param(parseFloat(slider.val()), pdef);\n\t\tnumInput.val(truncateFloat(value, 5));\n\t\taparam.setValueAtTime(value, 0);\t//TODO linear/log ramp at frame rate\n\t});\n\tnumInput.on('input', _ => {\n\t\tconst value = numInput.val();\n\t\tif (value.length == 0 || isNaN(value)) return;\n\t\tslider.val(param2slider(value, pdef));\n\t\taparam.setValueAtTime(value, 0);\t//TODO linear/log ramp at frame rate\n\t});\n}\n\nfunction renderParamControl(n: any, panel: JQuery) {\n\tif (!n.controlParams) return;\n\tconst combo = renderCombo(panel, n.controlParams, n.controlParam, 'Controlling');\n\tcombo.on('input', _ => {\n\t\tif (n.controlParam)\n\t\t\tn.anode.disconnect(n.controlTarget[n.controlParam]);\n\t\tn.controlParam = combo.val();\n\t\tn.anode.connect(n.controlTarget[n.controlParam]);\n\t});\n}\n\nfunction renderOtherParam(anode: AudioNode, ndef: NodeDef, param: string, panel: JQuery) {\n\tconst combo = renderCombo(panel, ndef.params[param].choices, anode[param], ucfirst(param));\n\tcombo.on('input', _ => {\n\t\tanode[param] = combo.val();\n\t});\n}\n\nfunction renderCombo(panel: JQuery, choices: string[], selected: string, label: string): JQuery {\n\tconst choiceBox = $('<div class=\"choice-box\">');\n\tconst combo = $('<select>').attr('size', choices.length);\n\tfor (const choice of choices) {\n\t\tconst option = $('<option>').text(choice);\n\t\tif (choice == selected) option.attr('selected', 'selected');\n\t\tcombo.append(option);\n\t}\n\tchoiceBox.append(combo);\n\tcombo.after('<br/><br/>' + label);\n\tpanel.append(choiceBox);\n\treturn combo;\n}\n\nconst LOG_BASE = 2;\n\nfunction logarithm(base: number, x: number): number {\n\treturn Math.log(x) / Math.log(base);\n}\n\nfunction param2slider(paramValue: number, pdef: NodeParamDef): number {\n\tif (pdef.linear) {\n\t\treturn (paramValue - pdef.min) / (pdef.max - pdef.min);\n\t}\n\telse {\n\t\tif (paramValue - pdef.min == 0) return 0;\n\t\tconst logRange = logarithm(LOG_BASE, pdef.max - pdef.min);\n\t\treturn logarithm(LOG_BASE, paramValue - pdef.min) / logRange;\n\t}\n}\n\nfunction slider2param(sliderValue: number, pdef: NodeParamDef): number {\n\tif (pdef.linear) {\n\t\treturn pdef.min + sliderValue * (pdef.max - pdef.min);\n\t}\n\telse {\n\t\tconst logRange = logarithm(LOG_BASE, pdef.max - pdef.min);\n\t\treturn pdef.min + Math.pow(LOG_BASE, sliderValue * logRange);\n\t}\n}\n\n\n//-------------------- Misc utilities --------------------\n\nfunction ucfirst(str: string) {\n\treturn str[0].toUpperCase() + str.substring(1);\n}\n\nfunction truncateFloat(f: number, len: number): string {\n\tlet s: string = '' + f;\n\ts = s.substr(0, len);\n\tif (s[s.length - 1] == '.') return s.substr(0, len - 1);\n\telse return s;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/paramsUI.ts\n **/"],"sourceRoot":""}