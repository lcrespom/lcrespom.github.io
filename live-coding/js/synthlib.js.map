{"version":3,"sources":["webpack:///webpack/bootstrap d4b640abbf6ef920739f","webpack:///./src/utils/modern.ts","webpack:///./src/synth/palette.ts","webpack:///./src/synth/customNodes.ts","webpack:///./src/utils/file.ts","webpack:///./src/synthlib.ts","webpack:///./src/synth/synth.ts","webpack:///./src/synth/timer.ts","webpack:///./src/synth/instrument.ts","webpack:///./src/synth/notes.ts"],"names":[],"mappings":"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","file":"synthlib.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 46);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d4b640abbf6ef920739f","/**\n * Modernize browser interfaces so that TypeScript does not complain\n * when using new features.\n *\n * Also provides some basic utility funcitons\n */\n\nexport interface ModernWindow extends Window {\n\tAudioContext: AudioContext\n\twebkitAudioContext: AudioContext\n}\n\nexport interface ModernAudioNode extends AudioNode {\n\tdisconnect(output?: number | AudioNode | AudioParam): void\n}\n\n\nexport function removeArrayElement(a: any[], e: any): boolean {\n\tconst pos = a.indexOf(e)\n\tif (pos < 0) return false\t// not found\n\ta.splice(pos, 1)\n\treturn true\n}\n\nconst LOG_BASE = 2\n\nfunction logarithm(base: number, x: number): number {\n\treturn Math.log(x) / Math.log(base)\n}\n\nexport function linear2log(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min)\n\treturn logarithm(LOG_BASE, value + 1 - min) / logRange\n}\n\nexport function log2linear(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min)\n\treturn min + Math.pow(LOG_BASE, value * logRange) - 1\n}\n\nexport function focusable(elem: HTMLElement | null): HTMLElement {\n\twhile (elem != null && elem.tabIndex < 0 &&\n\t\telem.nodeName.toLowerCase() != 'body')\n\t\telem = elem.parentElement\n\treturn elem || document.body\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/modern.ts","/** Configuration data for an AudioNode parameter */\nexport interface NodeParamDef {\n\tinitial: any\n\tmin?: number\n\tmax?: number\n\tlinear?: boolean\n\tchoices?: string[]\n\thandler?: string\n\tphandler?: any\n}\n\n/** Configuration data for an AudioNode */\nexport interface NodeDef {\n\tconstructor: string | null\n\tcustom?: boolean\n\tnoteHandler?: string\n\tcontrol?: boolean\n\tparams: { [key: string]: NodeParamDef }\n}\n\n/** A set of AudioNode configuration elements */\nexport interface NodePalette {\n\t[key: string]: NodeDef\n}\n\n// -------------------- Node palette definition --------------------\n\nconst OCTAVE_DETUNE: NodeParamDef = {\n\tinitial: 0,\n\tmin: -1200,\n\tmax: 1200,\n\tlinear: true\n}\n\n/**\n * The set of AudioNodes available to the application, along with\n * their configuration.\n */\nexport let palette: NodePalette = {\n\t// Sources\n\tOscillator: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'osc',\n\t\tparams: {\n\t\t\tfrequency: { initial: 220, min: 20, max: 20000 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sawtooth',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tBuffer: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'buffer',\n\t\tparams: {\n\t\t\tplaybackRate: { initial: 1, min: 0, max: 8 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'BufferDataHandler'\n\t\t\t},\n\t\t\tloop: { initial: false },\n\t\t\tloopStart: { initial: 0, min: 0, max: 10 },\n\t\t\tloopEnd: { initial: 3, min: 0, max: 10 }\n\t\t}\n\t},\n\tNoise: {\n\t\tconstructor: 'createNoise',\n\t\tnoteHandler: 'restartable',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tgain:  { initial: 1, min: 0, max: 10 }\n\t\t}\n\t},\n\tLineIn: {\n\t\tconstructor: 'createLineIn',\n\t\tcustom: true,\n\t\tparams: {}\n\t},\n\tSoundBank: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'soundBank',\n\t\tparams: {\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'SoundBankHandler'\n\t\t\t}\n\t\t}\n\t},\n\t// Effects\n\tGain: {\n\t\tconstructor: 'createGain',\n\t\tparams: {\n\t\t\tgain: { initial: 1, min: 0, max: 10, linear: true }\n\t\t}\n\t},\n\tFilter: {\n\t\tconstructor: 'createBiquadFilter',\n\t\tparams: {\n\t\t\tfrequency: { initial: 440, min: 20, max: 20000 },\n\t\t\tQ: { initial: 0, min: 0, max: 100 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tgain: { initial: 0, min: -40, max: 40, linear: true },\n\t\t\ttype: {\n\t\t\t\tinitial: 'lowpass',\n\t\t\t\tchoices: ['lowpass', 'highpass', 'bandpass',\n\t\t\t\t\t'lowshelf', 'highshelf', 'peaking', 'notch', 'allpass']\n\t\t\t}\n\t\t},\n\t},\n\tDelay: {\n\t\tconstructor: 'createDelay',\n\t\tparams: {\n\t\t\tdelayTime: { initial: 1, min: 0, max: 5 }\n\t\t}\n\t},\n\tStereoPan: {\n\t\tconstructor: 'createStereoPanner',\n\t\tparams: {\n\t\t\tpan: { initial: 0, min: -1, max: 1, linear: true }\n\t\t}\n\t},\n\tCompressor: {\n\t\tconstructor: 'createDynamicsCompressor',\n\t\tparams: {\n\t\t\tthreshold: { initial: -24, min: -100, max: 0, linear: true },\n\t\t\tknee: { initial: 30, min: 0, max: 40, linear: true },\n\t\t\tratio: { initial: 12, min: 1, max: 20, linear: true },\n\t\t\tattack: { initial: 0.003, min: 0, max: 1 },\n\t\t\trelease: { initial: 0.25, min: 0, max: 1 }\n\t\t}\n\t},\n\tDetuner: {\n\t\tconstructor: 'createDetuner',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\toctave: { initial: 0, min: -2, max: 2, linear: true }\n\t\t}\n\t},\n\t// Controllers\n\tLFO: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'LFO',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 5, min: 0.01, max: 200 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sine',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tGainCtrl: {\n\t\tconstructor: 'createGain',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tgain: { initial: 10, min: 0, max: 100, linear: true }\n\t\t}\n\t},\n\tADSR: {\n\t\tconstructor: 'createADSR',\n\t\tnoteHandler: 'ADSR',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tattack:  { initial: 0.2, min: 0, max: 10 },\n\t\t\tdecay:   { initial: 0.5, min: 0, max: 10 },\n\t\t\tsustain: { initial: 0.5, min: 0, max: 1, linear: true },\n\t\t\trelease: { initial: 1.0, min: 0, max: 10 },\n\t\t\tdepth:   { initial: 1.0, min: 0, max: 1 }\n\t\t}\n\t},\n\tNoiseCtrl: {\n\t\tconstructor: 'createNoiseCtrl',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 4, min: 0, max: 200 },\n\t\t\tdepth:  { initial: 20, min: 0, max: 200 }\n\t\t}\n\t},\n\t// Output\n\tSpeaker: {\n\t\tconstructor: null,\n\t\tparams: {}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/palette.ts","import { ModernAudioNode } from '../utils/modern'\n\n/**\n * Base class to derive all custom nodes from it\n */\nexport class CustomNodeBase implements ModernAudioNode {\n\tcustom = true\n\tchannelCount = 2\n\tchannelCountMode: ChannelCountMode = 'max'\n\tchannelInterpretation: ChannelInterpretation = 'speakers'\n\tcontext: AudioContext\n\tnumberOfInputs = 0\n\tnumberOfOutputs = 1\n\t// Connect - disconnect\n\tconnect(destination: AudioNode | AudioParam,\n\t\toutput?: number, input?: number): AudioNode {\n\t\t\treturn <AudioNode>destination\n\t\t}\n\tdisconnect(destination: AudioNode | AudioParam,\n\t\toutput?: number, input?: number): void {}\n\t// Required for extending EventTarget\n\taddEventListener() {}\n\tdispatchEvent(evt: Event): boolean { return false }\n\tremoveEventListener() {}\n}\n\n\n/**\n * Envelope generator that controls the evolution over time of a destination\n * node's parameter. All parameter control is performed in the corresponding\n * ADSR note handler.\n */\nexport class ADSR extends CustomNodeBase {\n\tattack = 0.2\n\tdecay = 0.5\n\tsustain = 0.5\n\trelease = 1\n\tdepth = 1\n\t// TODO linear / exponential\n}\n\n\n/**\n * Base ScriptProcessor, to derive all custom audio processing nodes from it.\n */\nexport class ScriptProcessor extends CustomNodeBase {\n\tgain = 1\n\tanode: ScriptProcessorNode\n\tplaying = false\n\n\tconstructor(ac: AudioContext) {\n\t\tsuper()\n\t\tthis.anode = ac.createScriptProcessor(1024)\n\t\tthis.anode.onaudioprocess = evt => this.processAudio(evt)\n\t}\n\n\tconnect(node: AudioNode) {\n\t\treturn this.anode.connect(node)\n\t}\n\n\tdisconnect() {\n\t\tthis.anode.disconnect()\n\t}\n\n\tstart() {\n\t\tthis.playing = true\n\t}\n\n\tstop() {\n\t\tthis.playing = false\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {}\n}\n\n\n/**\n * Simple noise generator\n */\nexport class NoiseGenerator extends ScriptProcessor {\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tconst out = evt.outputBuffer.getChannelData(channel)\n\t\t\tfor (let sample = 0; sample < out.length; sample++)\n\t\t\t\tout[sample] = this.playing ? this.gain * (Math.random() * 2 - 1) : 0\n\t\t}\n\t}\n}\n\n\n/**\n * Noise generator to be used as control node.\n * It uses sample & hold in order to implement the 'frequency' parameter.\n */\nexport class NoiseCtrlGenerator extends ScriptProcessor {\n\tac: AudioContext\n\tfrequency: number\n\tdepth: number\n\tsct: number\n\tv: number\n\n\tconstructor(ac: AudioContext) {\n\t\tsuper(ac)\n\t\tthis.ac = ac\n\t\tthis.frequency = 4\n\t\tthis.depth = 20\n\t\tthis.sct = 0\n\t\tthis.v = 0\n\t}\n\n\tconnect(param: any) {\n\t\treturn this.anode.connect(param)\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst samplesPerCycle = this.ac.sampleRate / this.frequency\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel)\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tthis.sct++\n\t\t\t\tif (this.sct > samplesPerCycle) {\n\t\t\t\t\tthis.v = this.depth * (Math.random() * 2 - 1)\n\t\t\t\t\tthis.sct = 0 // this.sct - Math.floor(this.sct);\n\t\t\t\t}\n\t\t\t\tout[sample] = this.v\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Simple Pitch Shifter implemented in a quick & dirty way\n */\nexport class Detuner extends ScriptProcessor {\n\toctave = 0\n\tnumberOfInputs = 1\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst dx = Math.pow(2, this.octave)\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel)\n\t\t\tlet inbuf = evt.inputBuffer.getChannelData(channel)\n\t\t\tlet sct = 0\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tout[sample] = inbuf[Math.floor(sct)]\n\t\t\t\tsct += dx\n\t\t\t\tif (sct >= inbuf.length) sct = 0\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Captures audio from the PC audio input.\n * Requires user's authorization to grab audio input.\n */\nexport class LineInNode extends CustomNodeBase {\n\tsrcNode: ModernAudioNode\n\tdstNode: ModernAudioNode\n\tstream: any\n\n\tconnect(anode: any) {\n\t\tif (this.srcNode) {\n\t\t\tthis.srcNode.connect(anode)\n\t\t\tthis.dstNode = anode\n\t\t\treturn anode\n\t\t}\n\t\tconst navigator: any = window.navigator\n\t\tnavigator.getUserMedia = (navigator.getUserMedia ||\n\t\t\tnavigator.webkitGetUserMedia ||\n\t\t\tnavigator.mozGetUserMedia ||\n\t\t\tnavigator.msGetUserMedia)\n\t\tnavigator.getUserMedia({ audio: true }, (stream: any) => {\n\t\t\tconst ac: any = anode.context\n\t\t\tthis.srcNode = ac.createMediaStreamSource(stream)\n\t\t\tlet a2: any = anode\n\t\t\tif (a2.custom && a2.anode) a2 = a2.anode\n\t\t\tthis.srcNode.connect(a2)\n\t\t\tthis.dstNode = anode\n\t\t\tthis.stream = stream\n\t\t}, (error: any) => console.error(error))\n\t}\n\n\tdisconnect() {\n\t\tthis.srcNode.disconnect(this.dstNode)\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/customNodes.ts","// -------------------- Encoding / decoding --------------------\n\nexport function arrayBufferToBase64(buffer: number[]) {\n\tlet binary = ''\n\tlet bytes = new Uint8Array(buffer)\n\tlet len = bytes.byteLength\n\tfor (let i = 0; i < len; i++) {\n\t\tbinary += String.fromCharCode(bytes[i])\n\t}\n\treturn window.btoa(binary)\n}\n\nexport function base64ToArrayBuffer(base64: string) {\n\tlet binary_string = window.atob(base64)\n\tlet len = binary_string.length\n\tlet bytes = new Uint8Array(len)\n\tfor (let i = 0; i < len; i++) {\n\t\tbytes[i] = binary_string.charCodeAt(i)\n\t}\n\treturn bytes.buffer\n}\n\n\n// -------------------- Downloading --------------------\n\nexport function browserSupportsDownload(): boolean {\n\treturn !(<any>window).externalHost && 'download' in $('<a>')[0]\n}\n\nexport function download(fileName: string, fileData: string) {\n\tconst a = $('<a>')\n\ta.attr('download', fileName)\n\ta.attr('href',\n\t\t'data:application/octet-stream;base64,' + btoa(fileData))\n\tconst clickEvent = new MouseEvent('click',\n\t\t{ view: window, bubbles: true, cancelable: false })\n\ta[0].dispatchEvent(clickEvent)\n}\n\n\n// -------------------- Uploading --------------------\n\nexport type UploadCallback = (buf: any, file: any) => void\n\nexport function uploadText(event: JQuery.Event, cb: UploadCallback) {\n\tupload(event, cb, 'readAsText')\n}\n\nexport function uploadArrayBuffer(event: JQuery.Event, cb: UploadCallback) {\n\tupload(event, cb, 'readAsArrayBuffer')\n}\n\nfunction upload(event: JQuery.Event, cb: UploadCallback, readFunc: string) {\n\tlet files = (<any>event.target).files\n\tif (!files || files.length <= 0) return cb('', '')\n\tconst file = files[0]\n\tconst reader = new FileReader()\n\treader.onload = (loadEvt: any) => cb(loadEvt.target.result, file);\n\t// let func = (<any>reader)[readFunc]\n\t// func.bind(reader)(file)\n\t(<any>reader)[readFunc](file)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/file.ts","/**\n * Library that exports the Instrument and Voice classes\n */\nimport { Instrument, Voice } from './synth/instrument'\nimport { Timer } from './synth/timer'\n\nconst global: any = window\nglobal.Modulator = global.Modulator || {}\n\nglobal.Modulator.Instrument = Instrument\nglobal.Modulator.Voice = Voice\nglobal.Modulator.Timer = Timer\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthlib.ts","import { NoteHandler, NoteHandlers } from './notes'\nimport { NodeDef, NodeParamDef, NodePalette, palette } from './palette'\nimport { ModernAudioNode, removeArrayElement } from '../utils/modern'\nimport * as custom from './customNodes'\nimport * as file from '../utils/file'\n\n\nconst SEMITONE = Math.pow(2, 1 / 12)\nconst A4 = 57\n\n/**\n * Holds all data associated with an AudioNode\n */\nexport class NodeData {\n\t// Used by all nodes\n\ttype: string\n\tanode: ModernAudioNode\n\tnodeDef: NodeDef\n\t// Used by control nodes\n\tcontrolParam: string\n\tcontrolParams: string[] | null\n\tcontrolTarget: ModernAudioNode\n\t// Used by source audio nodes\n\tnoteHandler: NoteHandler\n\t// Flag to avoid deleting output node\n\tisOut = false\n\t// Reference to owner synth\n\tsynth: Synth\n\t// To be implemented by user code\n\tgetInputs(): NodeData[] {\n\t\tthrow 'Error: getInputs() function should be implemented by user'\n\t}\n}\n\n/**\n * Global paramters that apply to the whole monophonic synthesizer.\n */\nexport class Portamento {\n\ttime = 0\n\tratio = 0\n}\n\n// TODO *** refactor & decouple from UI\nexport interface ParamHandler {\n\tuiRender: string\n\tinitialize(anode: AudioNode, def: NodeDef): void\n\tparam2json(anode: AudioNode): any\n\tjson2param(anode: AudioNode, json: any): any\n}\n\n/**\n * Performs global operations on all AudioNodes:\n * - Manages AudioNode creation, initialization and connection\n * - Distributes MIDI keyboard events to NoteHandlers\n */\nexport class Synth {\n\tac: AudioContext\n\tcustomNodes: { [key: string]: Function } = {}\n\tparamHandlers: { [key: string]: ParamHandler } = {}\n\tpalette: NodePalette\n\tnoteHandlers: NoteHandler[] = []\n\tportamento = new Portamento()\n\toutGainNode: GainNode\n\n\tconstructor(ac: AudioContext) {\n\t\tthis.ac = ac\n\t\tthis.palette = palette\n\t\tthis.registerCustomNode('createADSR', custom.ADSR)\n\t\tthis.registerCustomNode('createNoise', custom.NoiseGenerator)\n\t\tthis.registerCustomNode('createNoiseCtrl', custom.NoiseCtrlGenerator)\n\t\tthis.registerCustomNode('createLineIn', custom.LineInNode)\n\t\tthis.registerCustomNode('createDetuner', custom.Detuner)\n\t\tthis.registerParamHandler('BufferDataHandler', new BufferDataHandler())\n\t\tthis.registerParamHandler('SoundBankHandler', new SoundBankHandler())\n\t}\n\n\tcreateAudioNode(type: string): AudioNode | null {\n\t\tconst def: NodeDef = palette[type]\n\t\tif (!def) return null\n\t\tconst factory: any = def.custom ? this.customNodes : this.ac\n\t\tif (!def.constructor || !factory[def.constructor]) return null\n\t\tconst anode = factory[def.constructor]()\n\t\tif (!anode.context) anode.context = this.ac\n\t\tthis.initNodeParams(anode, def, type)\n\t\treturn anode\n\t}\n\n\tinitNodeData(ndata: NodeData, type: string) {\n\t\tndata.synth = this\n\t\tndata.type = type\n\t\tlet anode = this.createAudioNode(type)\n\t\tif (!anode)\n\t\t\tthrow new Error(`No AudioNode found for \"${type}\"`)\n\t\tndata.anode = anode\n\t\tndata.nodeDef = this.palette[type]\n\t\tconst nh = ndata.nodeDef.noteHandler\n\t\tif (nh) {\n\t\t\tndata.noteHandler = new (<any>NoteHandlers)[nh](ndata)\n\t\t\tthis.addNoteHandler(ndata.noteHandler)\n\t\t}\n\t\treturn anode\n\t}\n\n\tinitOutputNodeData(ndata: NodeData, dst: AudioNode) {\n\t\tndata.synth = this\n\t\tndata.type = 'out'\n\t\tthis.outGainNode = this.ac.createGain()\n\t\tndata.anode = this.outGainNode\n\t\tndata.anode.connect(dst)\n\t\tndata.nodeDef = this.palette['Speaker']\n\t\tndata.isOut = true\n\t\treturn ndata.anode\n\t}\n\n\tremoveNodeData(data: NodeData) {\n\t\tif (data.noteHandler)\n\t\t\tthis.removeNoteHandler(data.noteHandler)\n\t}\n\n\tconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tlet anode: any = dstData.anode\n\t\t\tsrcData.controlParams = Object.keys(dstData.nodeDef.params)\n\t\t\t\t.filter(pname => anode[pname] instanceof AudioParam)\n\t\t\tsrcData.controlParam = srcData.controlParams[0]\n\t\t\tsrcData.controlTarget = dstData.anode\n\t\t\tsrcData.anode.connect(anode[srcData.controlParam])\n\t\t}\n\t\telse srcData.anode.connect(dstData.anode)\n\t}\n\n\tdisconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tsrcData.controlParams = null\n\t\t\tsrcData.anode.disconnect((<any>dstData.anode)[srcData.controlParam])\n\t\t}\n\t\telse\n\t\t\tsrcData.anode.disconnect(dstData.anode)\n\t}\n\n\tjson2NodeData(json: any, data: NodeData): void {\n\t\tlet anydata: any = data\n\t\tfor (const pname of Object.keys(json.params)) {\n\t\t\tconst pvalue = anydata.anode[pname]\n\t\t\tconst jv = json.params[pname]\n\t\t\tif (anydata.nodeDef.params[pname].handler)\n\t\t\t\tthis.paramHandlers[anydata.nodeDef.params[pname].handler]\n\t\t\t\t\t.json2param(anydata.anode, jv)\n\t\t\telse if (pvalue instanceof AudioParam) {\n\t\t\t\tpvalue.value = jv;\n\t\t\t\t(<any>pvalue)['_value'] = jv\n\t\t\t}\n\t\t\telse anydata.anode[pname] = jv\n\t\t}\n\t}\n\n\tnodeData2json(data: any): any {\n\t\tconst params: any = {}\n\t\tfor (const pname of Object.keys(data.nodeDef.params)) {\n\t\t\tconst pvalue = data.anode[pname]\n\t\t\tif (data.nodeDef.params[pname].handler)\n\t\t\t\tparams[pname] = this.paramHandlers[data.nodeDef.params[pname].handler]\n\t\t\t\t\t.param2json(data.anode)\n\t\t\telse if (pvalue instanceof AudioParam)\n\t\t\t\tif ((<any>pvalue)['_value'] === undefined) params[pname] = pvalue.value\n\t\t\t\telse params[pname] = (<any>pvalue)['_value']\n\t\t\telse params[pname] = pvalue\n\t\t}\n\t\treturn {\n\t\t\ttype: data.type,\n\t\t\tparams,\n\t\t\tcontrolParam: data.controlParam,\n\t\t\tcontrolParams: data.controlParams\n\t\t}\n\t}\n\n\tmidi2freqRatio(midi: number): number {\n\t\treturn Math.pow(SEMITONE, midi - A4)\n\t}\n\n\tnoteOn(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime\n\t\tthis.outGainNode.gain.value = gain\n\t\tconst ratio = this.midi2freqRatio(midi)\n\t\tthis.setupNoteHandlers()\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOn(midi, gain, ratio, when)\n\t\tthis.portamento.ratio = ratio\n\t}\n\n\tnoteOff(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOff(midi, gain, when)\n\t}\n\n\taddNoteHandler(nh: NoteHandler): void {\n\t\tthis.noteHandlers.push(nh)\n\t}\n\n\tremoveNoteHandler(nh: NoteHandler): void {\n\t\tremoveArrayElement(this.noteHandlers, nh)\n\t}\n\n\tsetupNoteHandlers() {\n\t\tlet maxRelease = 0\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (nh.kbTrigger && nh.releaseTime > maxRelease)\n\t\t\t\tmaxRelease = nh.releaseTime\n\t\t}\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (!nh.kbTrigger)\n\t\t\t\tnh.releaseTime = maxRelease\n\t\t}\n\t}\n\n\tinitNodeParams(anode: AudioNode, def: NodeDef, type: string): void {\n\t\tlet anynode: any = anode\n\t\tfor (const param of Object.keys(def.params || {}))\n\t\t\tif (anynode[param] === undefined)\n\t\t\t\tconsole.warn(`Parameter '${param}' not found for node '${type}'`)\n\t\t\telse if (anynode[param] instanceof AudioParam)\n\t\t\t\tanynode[param].value = def.params[param].initial\n\t\t\telse if (def.params[param].handler) {\n\t\t\t\tdef.params[param].phandler = this.paramHandlers[def.params[param].handler || '']\n\t\t\t\tdef.params[param].phandler.initialize(anynode, def)\n\t\t\t}\n\t\t\telse\n\t\t\t\tanynode[param] = def.params[param].initial\n\t}\n\n\tregisterCustomNode(constructorName: string, nodeClass: any): void {\n\t\tthis.customNodes[constructorName] = () => new nodeClass(this.ac)\n\t}\n\n\tregisterParamHandler(hname: string, handler: ParamHandler): void {\n\t\tthis.paramHandlers[hname] = handler\n\t}\n\n}\n\n\n\n// -------------------- Parameter handlers --------------------\n\ninterface BufferAudioNode extends AudioNode {\n\t_encoded: any\n\t_buffer: AudioBuffer\n\t_buffers: AudioBuffer[]\n\t_encodedBuffers: any[]\n\t_names: string[]\n}\n\nclass BufferDataHandler implements ParamHandler {\n\tuiRender = 'renderBufferData'\n\tinitialize(anode: AudioNode, def: NodeDef): void {}\n\n\tparam2json(anode: BufferAudioNode): any {\n\t\treturn file.arrayBufferToBase64(anode._encoded)\n\t}\n\n\tjson2param(anode: BufferAudioNode, json: any) {\n\t\tconst encoded = file.base64ToArrayBuffer(json)\n\t\tanode._encoded = encoded\n\t\tanode.context.decodeAudioData(encoded, buffer => anode._buffer = buffer)\n\t}\n}\n\nclass SoundBankHandler implements ParamHandler {\n\tuiRender = 'renderSoundBank'\n\tinitialize(anode: BufferAudioNode, def: NodeDef): void {\n\t\tanode._buffers = []\n\t\tanode._encodedBuffers = []\n\t\tanode._names = []\n\t}\n\n\tparam2json(anode: BufferAudioNode): any {\n\t\tconst files = []\n\t\tconst encs = anode._encodedBuffers\n\t\tconst names = anode._names\n\t\tfor (let i = 0; i < names.length; i++)\n\t\t\tfiles.push({\n\t\t\t\tname: names[i],\n\t\t\t\tdata: file.arrayBufferToBase64(encs[i])\n\t\t\t})\n\t\treturn files\n\t}\n\n\tjson2param(anode: BufferAudioNode, json: any) {\n\t\tconst bufs = anode._buffers\n\t\tbufs.length = 0\n\t\tconst encs = anode._encodedBuffers\n\t\tencs.length = 0\n\t\tconst names = anode._names\n\t\tnames.length = 0\n\t\tfor (let i = 0; i < json.length; i++) {\n\t\t\tconst item = json[i]\n\t\t\tnames.push(item.name)\n\t\t\tconst encoded = file.base64ToArrayBuffer(item.data)\n\t\t\tencs.push(encoded)\n\t\t\tthis.decodeBuffer(anode, encoded, bufs, i)\n\t\t}\n\t}\n\n\tdecodeBuffer(anode: AudioNode, data: ArrayBuffer,\n\t\tbufs: any[], i: number) {\n\t\tanode.context.decodeAudioData(data, buffer => bufs[i] = buffer)\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/synth.ts","export interface TimerCallback {\n\t(time: number): void\n}\n\nexport class Timer {\n\trunning: boolean\n\tac: AudioContext\n\tcb: TimerCallback\n\t_bpm: number\n\tahead: number\n\tnextNoteTime: number\n\tnoteDuration: number\n\n\tconstructor(ac: AudioContext, bpm = 60, ahead = 0.1) {\n\t\tthis.running = false\n\t\tthis.ac = ac\n\t\tthis.noteDuration = 0\n\t\tthis.nextNoteTime = 0\n\t\tthis.bpm = bpm\n\t\tthis.ahead = ahead\n\t}\n\n\tget bpm() { return this._bpm }\n\n\tset bpm(v) {\n\t\tthis._bpm = v\n\t\tthis.nextNoteTime -= this.noteDuration\n\t\tthis.noteDuration = (1 / 4) * 60 / this._bpm\n\t\tthis.nextNoteTime += this.noteDuration\n\t}\n\n\tstart(cb?: TimerCallback): void {\n\t\tif (this.running) return\n\t\tthis.running = true\n\t\tif (cb) this.cb = cb\n\t\tthis.nextNoteTime = this.ac.currentTime\n\t\tthis.tick()\n\t}\n\n\tstop(): void {\n\t\tthis.running = false\n\t}\n\n\ttick(): void {\n\t\tif (!this.running) return\n\t\trequestAnimationFrame(this.tick.bind(this))\n\t\twhile (this.nextNoteTime < this.ac.currentTime + this.ahead) {\n\t\t\tif (this.cb) this.cb(this.nextNoteTime)\n\t\t\tthis.nextNoteTime += this.noteDuration\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/timer.ts","import { Synth, NodeData, Portamento } from './synth'\n\n\n/**\n * A polyphonic synth controlling an array of voices\n */\nexport class Instrument {\n\tvoices: Voice[]\n\tpressed: number[]\n\treleased: number[]\n\tportamento: Portamento\n\n\tconstructor(ac: AudioContext, json: any, numVoices: number, dest?: AudioNode) {\n\t\t// Setup voices\n\t\tthis.pressed = []\n\t\tthis.released = []\n\t\tthis.voices = []\n\t\tfor (let i = 0; i < numVoices; i++) {\n\t\t\tthis.voices.push(new Voice(ac, json, dest))\n\t\t\tthis.released.push(i)\n\t\t}\n\t\t// Setup synth params by having a common instance for all voices\n\t\tthis.portamento = this.voices[0].synth.portamento\n\t\tif (json.keyboard && json.keyboard.portamento)\n\t\t\tthis.portamento.time = json.keyboard.portamento\n\t\tfor (let i = 1; i < numVoices; i++)\n\t\t\tthis.voices[i].synth.portamento = this.portamento\n\t}\n\n\tnoteOn(midi: number, velocity = 1, when?: number): void {\n\t\tconst vnum = this.findVoice()\n\t\tconst voice = this.voices[vnum]\n\t\tthis.pressed.push(vnum)\n\t\tvoice.noteOn(midi, velocity, when)\n\t}\n\n\tnoteOff(midi: number, velocity = 1, when?: number): void {\n\t\tfor (let i = 0; i < this.voices.length; i++) {\n\t\t\tconst voice = this.voices[i]\n\t\t\tif (voice.lastNote == midi) {\n\t\t\t\tvoice.noteOff(midi, velocity, when)\n\t\t\t\tthis.released.push(i)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tallNotesOff() {\n\t\tfor (const voice of this.voices) {\n\t\t\tif (voice.lastNote) voice.noteOff(voice.lastNote)\n\t\t}\n\t}\n\n\tfindVoice(): number {\n\t\tlet voices: number[]\n\t\tif (this.released.length > 0) voices = this.released\n\t\telse if (this.pressed.length > 0) voices = this.pressed\n\t\telse throw 'This should never happen'\n\t\treturn voices.splice(0, 1)[0]\n\t}\n\n\tclose() {\n\t\tfor (const voice of this.voices) voice.close()\n\t}\n}\n\n\n/**\n * An independent monophonic synth\n */\nexport class Voice {\n\tsynth: Synth\n\tlastNote: number\n\tloader: SynthLoader\n\tnodes: NodeTable\n\n\tconstructor(ac: AudioContext, json: any, dest?: AudioNode) {\n\t\tthis.nodes = {}\n\t\tthis.loader = new SynthLoader()\n\t\tthis.synth = this.loader.load(ac, json, dest || ac.destination, this.nodes)\n\t\tthis.lastNote = 0\n\t}\n\n\tnoteOn(midi: number, velocity = 1, when?: number): void {\n\t\tthis.synth.noteOn(midi, velocity, when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, velocity = 1, when?: number): void {\n\t\tthis.synth.noteOff(midi, velocity, when)\n\t\tthis.lastNote = 0\n\t}\n\n\tgetParameterNode(nname: string, pname: string): AudioParam {\n\t\tlet n = this.nodes[nname]\n\t\tif (!n)\n\t\t\tthrow new Error(`Node \"${nname}\" not found`)\n\t\tlet prm = (<any>n)[pname]\n\t\tif (!prm)\n\t\t\tthrow new Error(`Parameter \"${pname}\" not found in node \"${nname}\"`)\n\t\treturn prm\n\t}\n\n\tclose(): void {\n\t\t// This method must be called to avoid memory leaks at the Web Audio level\n\t\tif (this.lastNote) this.noteOff(this.lastNote, 1)\n\t\tthis.loader.close()\n\t}\n}\n\n\n// -------------------- Private --------------------\n\nclass VoiceNodeData extends NodeData {\n\tinputs: NodeData[] = []\n\tconstructor(public id: number) {\n\t\tsuper()\n\t}\n\tgetInputs(): NodeData[] {\n\t\treturn this.inputs\n\t}\n}\n\ninterface NodeTable {\n\t[k: string]: AudioNode\n}\n\nclass SynthLoader {\n\tnodes: VoiceNodeData[] = []\n\tsynth: Synth\n\n\tload(ac: AudioContext, json: any, dest: AudioNode, nodes: NodeTable): Synth {\n\t\tconst synth = new Synth(ac)\n\t\t// Add nodes into id-based table\n\t\tlet j = 0\n\t\tfor (const jn of json.nodes)\n\t\t\tthis.nodes[j++] = new VoiceNodeData(jn.id)\n\t\t// Then set their list of inputs\n\t\tfor (let i = 0; i < json.nodes.length; i++)\n\t\t\tfor (const inum of json.nodes[i].inputs) {\n\t\t\t\tlet input = this.nodeById(inum)\n\t\t\t\tif (input) this.nodes[i].inputs.push(input)\n\t\t\t}\n\t\t// Then set their data\n\t\tfor (let i = 0; i < json.nodes.length; i++) {\n\t\t\tconst type = json.nodeData[i].type\n\t\t\tlet anode: AudioNode\n\t\t\tif (type == 'out')\n\t\t\t\tanode = synth.initOutputNodeData(this.nodes[i], dest)\n\t\t\telse\n\t\t\t\tanode = synth.initNodeData(this.nodes[i], type)\n\t\t\tsynth.json2NodeData(json.nodeData[i], this.nodes[i])\n\t\t\tthis.registerNode(anode, nodes, json.nodes[i].name)\n\t\t}\n\t\t// Then notify connections to handler\n\t\tfor (const dst of this.nodes)\n\t\t\tfor (const src of dst.inputs)\n\t\t\t\tsynth.connectNodes(src, dst)\n\t\t// Finally, return the newly created synth\n\t\tthis.synth = synth\n\t\treturn synth\n\t}\n\n\tnodeById(id: number): VoiceNodeData | null {\n\t\tfor (const node of this.nodes)\n\t\t\tif (node.id === id) return node\n\t\treturn null\n\t}\n\n\tregisterNode(anode: AudioNode, nodes: NodeTable, name: string) {\n\t\tnodes[name] = anode\n\t}\n\n\tclose() {\n\t\tfor (const node of this.nodes)\n\t\t\tfor (const input of node.inputs)\n\t\t\t\tthis.synth.disconnectNodes(input, node)\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/instrument.ts","import { NodeData } from './synth'\nimport { ADSR } from './customNodes'\nimport { ModernAudioNode, removeArrayElement } from '../utils/modern'\n\n\n/**\n * A note handler handles MIDI keyboard events on behalf of a synth node,\n * updating the node status accordingly.\n */\nexport interface NoteHandler {\n\tkbTrigger: boolean\n\treleaseTime: number\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void\n\tnoteOff(midi: number, gain: number, when: number): void\n}\n\n/**\n * Handles common AudioNode cloning, used by oscillator and buffered data nodes.\n */\nexport class BaseNoteHandler implements NoteHandler {\n\tndata: NodeData\n\toutTracker: OutputTracker\n\tkbTrigger = false\n\treleaseTime = 0\n\n\tconstructor(ndata: NodeData) {\n\t\tthis.ndata = ndata\n\t\tthis.outTracker = new OutputTracker(ndata.anode)\n\t}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {}\n\tnoteOff(midi: number, gain: number, when: number): void {}\n\n\tclone(): AudioNode | null {\n\t\t// Create clone\n\t\tlet ctor = this.ndata.nodeDef.constructor\n\t\tif (!ctor) return null\n\t\tconst anode = (<any>this.ndata.anode.context)[ctor]()\n\t\t// Copy parameters\n\t\tfor (const pname of Object.keys(this.ndata.nodeDef.params)) {\n\t\t\tconst param = (<any>this.ndata.anode)[pname]\n\t\t\tif (param instanceof AudioParam)\n\t\t\t\tanode[pname].value = param.value\n\t\t\telse if (param !== null && param !== undefined)\n\t\t\t\tanode[pname] = param\n\t\t}\n\t\t// Copy output connections\n\t\tfor (const out of this.outTracker.outputs) {\n\t\t\tlet o2: any = out\n\t\t\tif (o2.custom && o2.anode) o2 = o2.anode\n\t\t\tanode.connect(o2)\n\t\t}\n\t\t// Copy control input connections\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.connect(anode[inData.controlParam])\n\t\t}\n\t\t// TODO should copy snapshot of list of inputs and outputs\n\t\t// ...in case user connects or disconnects during playback\n\t\treturn anode\n\t}\n\n\tdisconnect(anode: ModernAudioNode): void {\n\t\t// Disconnect outputs\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tanode.disconnect(out)\n\t\t// Disconnect control inputs\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.disconnect((<any>anode)[inData.controlParam])\n\t\t}\n\t}\n\n\trampParam(param: MAudioParam, ratio: number, when: number): void {\n\t\tconst portamento = this.ndata.synth.portamento\n\t\tconst newv = param.value * ratio\n\t\tparam._value = newv\t// Required for ADSR to capture the correct value\n\t\tif (portamento.time > 0 && portamento.ratio > 0) {\n\t\t\tconst oldv = param.value * portamento.ratio\n\t\t\tparam.cancelScheduledValues(when)\n\t\t\tparam.linearRampToValueAtTime(oldv, when)\n\t\t\tparam.exponentialRampToValueAtTime(newv, when + portamento.time)\n\t\t}\n\t\telse param.setValueAtTime(newv, when)\n\t}\n}\n\n/**\n * Handles note events for an OscillatorNode\n */\nexport class OscNoteHandler extends BaseNoteHandler {\n\toscClone: OscillatorNode\n\tlastNote: number\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tif (this.oscClone) this.oscClone.stop(when)\n\t\tthis.oscClone = <OscillatorNode>this.clone()\n\t\tthis.rampParam(<MAudioParam>this.oscClone.frequency, ratio, when)\n\t\tthis.oscClone.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\t// Avoid multple keys artifacts in mono mode\n\t\tthis.oscClone.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Handles note events for an LFO node. This is identical to a regular\n * oscillator node, but the note does not affect the oscillator frequency\n */\nexport class LFONoteHandler extends OscNoteHandler {\n\trampParam(param: AudioParam, ratio: number, when: number) {\n\t\t// Disable portamento for LFO\n\t\tparam.setValueAtTime(param.value, when)\n\t}\n}\n\n/**\n * Handles note events for an AudioBufferSourceNode\n */\nexport class BufferNoteHandler extends BaseNoteHandler {\n\tabsn: AudioBufferSourceNode\n\tlastNote: number\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tif (this.absn)\n\t\t\tthis.absn.stop(when)\n\t\tconst buf = (<any>this.ndata.anode)._buffer\n\t\tif (!buf) return\t// Buffer still loading or failed\n\t\tthis.absn = <AudioBufferSourceNode>this.clone()\n\t\tthis.absn.buffer = buf\n\t\tconst pbr = this.absn.playbackRate\n\t\tconst newRate = pbr.value * ratio\n\t\tthis.rampParam(<MAudioParam>pbr, pbr.value * ratio, when)\n\t\tthis.absn.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\n\t\tthis.absn.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Performs computations about ramps so they can be easily rescheduled\n */\nexport class Ramp {\n\tconstructor(public v1: number, public v2: number, public t1: number, public t2: number) {}\n\tinside(t: number) {\n\t\treturn this.t1 < this.t2 && this.t1 <= t && t <= this.t2\n\t}\n\tcut(t: number) {\n\t\tconst newv = this.v1 + (this.v2 - this.v1) * (t - this.t1) / (this.t2 - this.t1)\n\t\treturn new Ramp(this.v1, newv, this.t1, t)\n\t}\n\trun(p: AudioParam, follow = false) {\n\t\tif (this.t2 - this.t1 <= 0) {\n\t\t\tp.setValueAtTime(this.v2, this.t2)\n\t\t}\n\t\telse {\n\t\t\tif (!follow) p.setValueAtTime(this.v1, this.t1)\n\t\t\tp.linearRampToValueAtTime(this.v2, this.t2)\n\t\t}\n\t}\n}\n\nexport interface MAudioParam extends AudioParam {\n\t_attack: Ramp\n\t_decay: Ramp\n\t_release: Ramp\n\t_value: number\n}\n/**\n * Handles note events for a custom ADSR node\n */\nexport class ADSRNoteHandler extends BaseNoteHandler {\n\tlastNote: number\n\tkbTrigger = true\n\n\tconstructor(ndata: NodeData) {\n\t\tsuper(ndata)\n\t\tconst adsr = this.getADSR()\n\t\tconst oldMethod = adsr.disconnect\n\t\tadsr.disconnect = (dest: AudioParam) => {\n\t\t\tthis.loopParams(param => {\n\t\t\t\tif (param == dest)\n\t\t\t\t\tparam.setValueAtTime(param._value, adsr.context.currentTime)\n\t\t\t})\n\t\t\toldMethod(dest)\n\t\t}\n\t}\n\n\tgetADSR(): ADSR {\n\t\tlet anode: any = this.ndata.anode\n\t\treturn anode\n\t}\n\n\tget releaseTime() {\n\t\tconst adsr = this.getADSR()\n\t\treturn adsr.release\n\t}\n\tset releaseTime(relTime: number) {}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tthis.lastNote = midi\n\t\tconst adsr = this.getADSR()\n\t\tthis.loopParams(param => {\n\t\t\tconst v = this.getParamValue(param)\n\t\t\tconst initial = (1 - adsr.depth) * v\n\t\t\tconst sustain = v * adsr.sustain + initial * (1 - adsr.sustain)\n\t\t\tconst now = adsr.context.currentTime\n\t\t\tparam.cancelScheduledValues(now)\n\t\t\tif (when > now)\n\t\t\t\tthis.rescheduleRamp(param, param._release, now)\n\t\t\tparam._attack = new Ramp(initial, v, when, when + adsr.attack)\n\t\t\tparam._decay = new Ramp(v, sustain, when + adsr.attack, when + adsr.attack + adsr.decay)\n\t\t\tparam._attack.run(param)\n\t\t\tparam._decay.run(param, true)\n\t\t})\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\t// Avoid multple keys artifacts in mono mode\n\t\tconst adsr = this.getADSR()\n\t\tthis.loopParams(param => {\n\t\t\tlet v = this.getRampValueAtTime(param, when)\n\t\t\tif (v === null)\n\t\t\t\tv = this.getParamValue(param) * adsr.sustain\n\t\t\tconst finalv = (1 - adsr.depth) * v\n\t\t\tparam.cancelScheduledValues(when)\n\t\t\tconst now = adsr.context.currentTime\n\t\t\tif (when > now)\n\t\t\t\t// tslint:disable-next-line:no-unused-expression\n\t\t\t\tthis.rescheduleRamp(param, param._attack, now) ||\n\t\t\t\tthis.rescheduleRamp(param, param._decay, now)\n\t\t\tparam._release = new Ramp(v, finalv, when, when + adsr.release)\n\t\t\tparam._release.run(param)\n\t\t})\n\t}\n\n\trescheduleRamp(param: MAudioParam, ramp: Ramp, now: number): boolean {\n\t\tif (ramp && ramp.inside(now)) {\n\t\t\tramp.cut(now).run(param)\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t}\n\n\tgetRampValueAtTime(param: MAudioParam, t: number): number | null {\n\t\tlet ramp\n\t\tif (param._attack && param._attack.inside(t))\n\t\t\treturn param._attack.cut(t).v2\n\t\tif (param._decay && param._decay.inside(t))\n\t\t\treturn param._decay.cut(t).v2\n\t\treturn null\n\t}\n\n\tloopParams(cb: (out: MAudioParam) => void): void {\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tif (out instanceof AudioParam)\n\t\t\t\tcb(<MAudioParam>out)\n\t}\n\n\tgetParamValue(p: MAudioParam): number {\n\t\tif (p._value === undefined) p._value = p.value\n\t\treturn p._value\n\t}\n}\n\n/**\n * Handles note events for any node that allows calling start() after stop(),\n * such as custom nodes.\n */\nexport class RestartableNoteHandler extends BaseNoteHandler {\n\tlastNote: number\n\tplaying = false\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tconst anode: any = this.ndata.anode\n\t\tif (this.playing)\n\t\t\tanode.stop(when)\n\t\tthis.playing = true\n\t\tanode.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\n\t\tthis.playing = false\n\t\tconst anode: any = this.ndata.anode\n\t\tanode.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Handles note events for the SoundBank source node\n */\nexport class SoundBankNoteHandler extends BaseNoteHandler {\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number) {\n\t\tconst bufs = (<any>this.ndata.anode)['_buffers']\n\t\tconst absn = <AudioBufferSourceNode>this.clone()\n\t\tabsn.buffer = bufs[midi % bufs.length]\n\t\tabsn.start(when)\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number) {}\n}\n\n// -------------------- Exported note handlers --------------------\n\n/**\n * Exports available note handlers so they are used by their respective\n * nodes from the palette.\n */\nexport const NoteHandlers = {\n\t'osc': OscNoteHandler,\n\t'buffer': BufferNoteHandler,\n\t'ADSR': ADSRNoteHandler,\n\t'LFO': LFONoteHandler,\n\t'restartable': RestartableNoteHandler,\n\t'soundBank': SoundBankNoteHandler\n}\n\n\n// -------------------- Private classes --------------------\n\n/**\n * Tracks a node output connections and disconnections, to be used\n * when cloning, removing or controlling nodes.\n */\nexport class OutputTracker {\n\toutputs: (AudioNode | AudioParam) [] = []\n\n\tconstructor(anode: AudioNode) {\n\t\tthis.onBefore(anode, 'connect', this.connect, (oldf, obj, args) => {\n\t\t\tif (args[0].custom && args[0].anode) args[0] = args[0].anode\n\t\t\toldf.apply(obj, args)\n\t\t})\n\t\tthis.onBefore(anode, 'disconnect', this.disconnect)\n\t}\n\n\tconnect(np: AudioParam) {\n\t\tthis.outputs.push(np)\n\t}\n\n\tdisconnect(np: AudioParam) {\n\t\tremoveArrayElement(this.outputs, np)\n\t}\n\n\tonBefore(obj: any, fname: string, funcToCall: Function,\n\t\tcb?: (oldf: Function, obj: any, args: any) => void): void {\n\t\tconst oldf = obj[fname]\n\t\tconst self = this\n\t\tobj[fname] = function() {\n\t\t\tfuncToCall.apply(self, arguments)\n\t\t\tif (cb) cb(oldf, obj, arguments)\n\t\t\telse oldf.apply(obj, arguments)\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/notes.ts"],"sourceRoot":""}