{"version":3,"sources":["webpack:///webpack/bootstrap 90e8cc33fac41bed4c41?a665","webpack:///./ts/synthlib.ts","webpack:///./ts/synth/synth.ts?037f","webpack:///./ts/synth/notes.ts?cc85","webpack:///./ts/utils/modern.ts?1463","webpack:///./ts/synth/palette.ts?5067","webpack:///./ts/synth/customNodes.ts?1116","webpack:///./ts/utils/file.ts?972c","webpack:///./ts/synth/timer.ts?ce60","webpack:///./ts/synth/instrument.ts?3529"],"names":["NodeData","NodeData.constructor","NodeData.getInputs","Portamento","Portamento.constructor","Synth","Synth.constructor","Synth.createAudioNode","Synth.initNodeData","Synth.initOutputNodeData","Synth.removeNodeData","Synth.connectNodes","Synth.disconnectNodes","Synth.json2NodeData","Synth.nodeData2json","Synth.midi2freqRatio","Synth.noteOn","Synth.noteOff","Synth.addNoteHandler","Synth.removeNoteHandler","Synth.setupNoteHandlers","Synth.initNodeParams","Synth.registerCustomNode","Synth.registerParamHandler","BufferDataHandler","BufferDataHandler.constructor","BufferDataHandler.initialize","BufferDataHandler.param2json","BufferDataHandler.json2param","SoundBankHandler","SoundBankHandler.constructor","SoundBankHandler.initialize","SoundBankHandler.param2json","SoundBankHandler.json2param","SoundBankHandler.decodeBuffer","BaseNoteHandler","BaseNoteHandler.constructor","BaseNoteHandler.noteOn","BaseNoteHandler.noteOff","BaseNoteHandler.clone","BaseNoteHandler.disconnect","BaseNoteHandler.rampParam","OscNoteHandler","OscNoteHandler.constructor","OscNoteHandler.noteOn","OscNoteHandler.noteOff","LFONoteHandler","LFONoteHandler.constructor","LFONoteHandler.rampParam","BufferNoteHandler","BufferNoteHandler.constructor","BufferNoteHandler.noteOn","BufferNoteHandler.noteOff","Ramp","Ramp.constructor","Ramp.inside","Ramp.cut","Ramp.run","ADSRNoteHandler","ADSRNoteHandler.constructor","ADSRNoteHandler.releaseTime","ADSRNoteHandler.noteOn","ADSRNoteHandler.noteOff","ADSRNoteHandler.rescheduleRamp","ADSRNoteHandler.getRampValueAtTime","ADSRNoteHandler.loopParams","ADSRNoteHandler.getParamValue","RestartableNoteHandler","RestartableNoteHandler.constructor","RestartableNoteHandler.noteOn","RestartableNoteHandler.noteOff","SoundBankNoteHandler","SoundBankNoteHandler.constructor","SoundBankNoteHandler.noteOn","SoundBankNoteHandler.noteOff","OutputTracker","OutputTracker.constructor","OutputTracker.connect","OutputTracker.disconnect","OutputTracker.onBefore","removeArrayElement","logarithm","linear2log","log2linear","focusable","CustomNodeBase","CustomNodeBase.constructor","CustomNodeBase.connect","CustomNodeBase.disconnect","CustomNodeBase.addEventListener","CustomNodeBase.dispatchEvent","CustomNodeBase.removeEventListener","ADSR","ADSR.constructor","ScriptProcessor","ScriptProcessor.constructor","ScriptProcessor.connect","ScriptProcessor.disconnect","ScriptProcessor.start","ScriptProcessor.stop","ScriptProcessor.processAudio","NoiseGenerator","NoiseGenerator.constructor","NoiseGenerator.processAudio","NoiseCtrlGenerator","NoiseCtrlGenerator.constructor","NoiseCtrlGenerator.connect","NoiseCtrlGenerator.processAudio","Detuner","Detuner.constructor","Detuner.processAudio","LineInNode","LineInNode.constructor","LineInNode.connect","LineInNode.disconnect","arrayBufferToBase64","base64ToArrayBuffer","browserSupportsDownload","download","uploadText","uploadArrayBuffer","upload","Timer","Timer.constructor","Timer.bpm","Timer.start","Timer.stop","Timer.tick","Instrument","Instrument.constructor","Instrument.noteOn","Instrument.noteOff","Instrument.allNotesOff","Instrument.findVoice","Instrument.close","Voice","Voice.constructor","Voice.noteOn","Voice.noteOff","Voice.close","VoiceNodeData","VoiceNodeData.constructor","VoiceNodeData.getInputs","SynthLoader","SynthLoader.constructor","SynthLoader.load","SynthLoader.nodeById","SynthLoader.close"],"mappings":"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","file":"synthlib.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 90e8cc33fac41bed4c41\n **/","/**\n * Library that exports the Instrument and Voice classes\n */\nimport { Instrument, Voice } from './synth/instrument';\nimport { Timer } from './synth/timer';\n\nconst global: any = window;\nglobal.Modulator = global.Modulator || {};\n\nglobal.Modulator.Instrument = Instrument;\nglobal.Modulator.Voice = Voice;\nglobal.Modulator.Timer = Timer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synthlib.ts\n **/","import { NoteHandler, NoteHandlers } from './notes';\nimport { NodeDef, NodeParamDef, NodePalette, palette } from './palette';\nimport { ModernAudioContext, ModernAudioNode, removeArrayElement } from '../utils/modern';\nimport * as custom from './customNodes';\nimport * as file from '../utils/file';\n\n\nconst SEMITONE = Math.pow(2, 1/12);\nconst A4 = 57;\n\n/**\n * Holds all data associated with an AudioNode\n */\nexport class NodeData {\n\t// Used by all nodes\n\ttype: string;\n\tanode: ModernAudioNode;\n\tnodeDef: NodeDef;\n\t// Used by control nodes\n\tcontrolParam: string;\n\tcontrolParams: string[];\n\tcontrolTarget: ModernAudioNode;\n\t// Used by source audio nodes\n\tnoteHandler: NoteHandler;\n\t// Flag to avoid deleting output node\n\tisOut: boolean = false;\n\t// Reference to owner synth\n\tsynth: Synth;\n\t// To be implemented by user code\n\tgetInputs(): NodeData[] {\n\t\tthrow 'Error: getInputs() function should be implemented by user';\n\t}\n}\n\n/**\n * Global paramters that apply to the whole monophonic synthesizer.\n */\nexport class Portamento {\n\ttime = 0;\n\tratio = 0;\n}\n\n//TODO *** refactor & decouple from UI\ninterface ParamHandler {\n\tuiRender: string;\n\tinitialize(anode: AudioNode, def: NodeDef): void;\n\tparam2json(anode: AudioNode): any;\n\tjson2param(anode: AudioNode, json: any);\n}\n\n/**\n * Performs global operations on all AudioNodes:\n * - Manages AudioNode creation, initialization and connection\n * - Distributes MIDI keyboard events to NoteHandlers\n */\nexport class Synth {\n\tac: ModernAudioContext;\n\tcustomNodes: { [key: string]: Function } = {};\n\tparamHandlers: { [key: string]: ParamHandler } = {};\n\tpalette: NodePalette;\n\tnoteHandlers: NoteHandler[] = [];\n\tportamento = new Portamento();\n\n\tconstructor(ac: ModernAudioContext) {\n\t\tthis.ac = ac;\n\t\tthis.palette = palette;\n\t\tthis.registerCustomNode('createADSR', custom.ADSR);\n\t\tthis.registerCustomNode('createNoise', custom.NoiseGenerator);\n\t\tthis.registerCustomNode('createNoiseCtrl', custom.NoiseCtrlGenerator);\n\t\tthis.registerCustomNode('createLineIn', custom.LineInNode);\n\t\tthis.registerCustomNode('createDetuner', custom.Detuner);\n\t\tthis.registerParamHandler('BufferDataHandler', new BufferDataHandler());\n\t\tthis.registerParamHandler('SoundBankHandler', new SoundBankHandler());\n\t}\n\n\tcreateAudioNode(type: string): AudioNode {\n\t\tconst def: NodeDef = palette[type];\n\t\tif (!def) return null;\n\t\tconst factory = def.custom ? this.customNodes : this.ac;\n\t\tif (!factory[def.constructor]) return null;\n\t\tconst anode = factory[def.constructor]();\n\t\tif (!anode.context) anode.context = this.ac;\n\t\tthis.initNodeParams(anode, def, type);\n\t\treturn anode;\n\t}\n\n\tinitNodeData(ndata: NodeData, type: string): void {\n\t\tndata.synth = this;\n\t\tndata.type = type;\n\t\tndata.anode = this.createAudioNode(type);\n\t\tif (!ndata.anode)\n\t\t\treturn console.error(`No AudioNode found for '${type}'`);\n\t\tndata.nodeDef = this.palette[type];\n\t\tconst nh = ndata.nodeDef.noteHandler;\n\t\tif (nh) {\n\t\t\tndata.noteHandler = new NoteHandlers[nh](ndata);\n\t\t\tthis.addNoteHandler(ndata.noteHandler);\n\t\t}\n\t}\n\n\tinitOutputNodeData(ndata: NodeData, dst: AudioNode): void {\n\t\tndata.synth = this;\n\t\tndata.type = 'out';\n\t\tndata.anode = this.ac.createGain();\n\t\tndata.anode.connect(dst);\n\t\tndata.nodeDef = this.palette['Speaker'];\n\t\tndata.isOut = true;\n\t}\n\n\tremoveNodeData(data: NodeData) {\n\t\tif (data.noteHandler)\n\t\t\tthis.removeNoteHandler(data.noteHandler);\n\t}\n\n\tconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tsrcData.controlParams = Object.keys(dstData.nodeDef.params)\n\t\t\t\t.filter(pname => dstData.anode[pname] instanceof AudioParam);\n\t\t\tsrcData.controlParam = srcData.controlParams[0];\n\t\t\tsrcData.controlTarget = dstData.anode;\n\t\t\tsrcData.anode.connect(dstData.anode[srcData.controlParam]);\n\t\t}\n\t\telse srcData.anode.connect(dstData.anode);\n\t}\n\n\tdisconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tsrcData.controlParams = null;\n\t\t\tsrcData.anode.disconnect(dstData.anode[srcData.controlParam]);\n\t\t}\n\t\telse\n\t\t\tsrcData.anode.disconnect(dstData.anode);\n\t}\n\n\tjson2NodeData(json: any, data: NodeData): void {\n\t\tfor (const pname of Object.keys(json.params)) {\n\t\t\tconst pvalue = data.anode[pname];\n\t\t\tconst jv = json.params[pname];\n\t\t\tif (data.nodeDef.params[pname].handler)\n\t\t\t\tthis.paramHandlers[data.nodeDef.params[pname].handler]\n\t\t\t\t\t.json2param(data.anode, jv);\n\t\t\telse if (pvalue instanceof AudioParam) {\n\t\t\t\tpvalue.value = jv;\n\t\t\t\tpvalue['_value'] = jv;\n\t\t\t}\n\t\t\telse data.anode[pname] = jv;\n\t\t}\n\t}\n\n\tnodeData2json(data: NodeData): any {\n\t\tconst params = {};\n\t\tfor (const pname of Object.keys(data.nodeDef.params)) {\n\t\t\tconst pvalue = data.anode[pname];\n\t\t\tif (data.nodeDef.params[pname].handler)\n\t\t\t\tparams[pname] = this.paramHandlers[data.nodeDef.params[pname].handler]\n\t\t\t\t\t.param2json(data.anode);\n\t\t\telse if (pvalue instanceof AudioParam)\n\t\t\t\tif (pvalue['_value'] === undefined) params[pname] = pvalue.value;\n\t\t\t\telse params[pname] = pvalue['_value'];\n\t\t\telse params[pname] = pvalue;\n\t\t}\n\t\treturn {\n\t\t\ttype: data.type,\n\t\t\tparams,\n\t\t\tcontrolParam: data.controlParam,\n\t\t\tcontrolParams: data.controlParams\n\t\t}\n\t}\n\n\tmidi2freqRatio(midi: number): number {\n\t\treturn Math.pow(SEMITONE, midi - A4);\n\t}\n\n\tnoteOn(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime;\n\t\tconst ratio = this.midi2freqRatio(midi);\n\t\tthis.setupNoteHandlers();\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOn(midi, gain, ratio, when);\n\t\tthis.portamento.ratio = ratio;\n\t}\n\n\tnoteOff(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime;\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOff(midi, gain, when);\n\t}\n\n\taddNoteHandler(nh: NoteHandler): void {\n\t\tthis.noteHandlers.push(nh);\n\t}\n\n\tremoveNoteHandler(nh: NoteHandler): void {\n\t\tremoveArrayElement(this.noteHandlers, nh)\n\t}\n\n\tsetupNoteHandlers() {\n\t\tlet maxRelease = 0;\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (nh.kbTrigger && nh.releaseTime > maxRelease)\n\t\t\t\tmaxRelease = nh.releaseTime;\n\t\t}\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (!nh.kbTrigger)\n\t\t\t\tnh.releaseTime = maxRelease;\n\t\t}\n\t}\n\n\tinitNodeParams(anode: AudioNode, def: NodeDef, type: string): void {\n\t\tfor (const param of Object.keys(def.params || {}))\n\t\t\tif (anode[param] === undefined)\n\t\t\t\tconsole.warn(`Parameter '${param}' not found for node '${type}'`)\n\t\t\telse if (anode[param] instanceof AudioParam)\n\t\t\t\tanode[param].value = def.params[param].initial;\n\t\t\telse if (def.params[param].handler) {\n\t\t\t\tdef.params[param].phandler = this.paramHandlers[def.params[param].handler];\n\t\t\t\tdef.params[param].phandler.initialize(anode, def);\n\t\t\t}\n\t\t\telse\n\t\t\t\tanode[param] = def.params[param].initial;\n\t}\n\n\tregisterCustomNode(constructorName: string, nodeClass: any): void {\n\t\tthis.customNodes[constructorName] = () => new nodeClass(this.ac);\n\t}\n\n\tregisterParamHandler(hname: string, handler: ParamHandler): void {\n\t\tthis.paramHandlers[hname] = handler;\n\t}\n\n}\n\n\n\n//-------------------- Parameter handlers --------------------\n\nclass BufferDataHandler implements ParamHandler {\n\tuiRender = 'renderBufferData';\n\tinitialize(anode: AudioNode, def: NodeDef): void {}\n\n\tparam2json(anode: AudioNode): any {\n\t\treturn file.arrayBufferToBase64(anode['_encoded']);\n\t}\n\n\tjson2param(anode: AudioNode, json: any) {\n\t\tconst encoded = file.base64ToArrayBuffer(json);\n\t\tanode['_encoded'] = encoded;\n\t\tanode.context.decodeAudioData(encoded, buffer => anode['_buffer'] = buffer);\n\t}\n}\n\nclass SoundBankHandler implements ParamHandler {\n\tuiRender = 'renderSoundBank';\n\tinitialize(anode: AudioNode, def: NodeDef): void {\n\t\tanode['_buffers'] = [];\n\t\tanode['_encodedBuffers'] = [];\n\t\tanode['_names'] = [];\n\t}\n\n\tparam2json(anode: AudioNode): any {\n\t\tconst files = [];\n\t\tconst encs = anode['_encodedBuffers'];\n\t\tconst names = anode['_names'];\n\t\tfor (let i = 0; i < names.length; i++)\n\t\t\tfiles.push({\n\t\t\t\tname: names[i],\n\t\t\t\tdata: file.arrayBufferToBase64(encs[i])\n\t\t\t});\n\t\treturn files;\n\t}\n\n\tjson2param(anode: AudioNode, json: any) {\n\t\tconst bufs = anode['_buffers'];\n\t\tbufs.length = 0;\n\t\tconst encs = anode['_encodedBuffers'];\n\t\tencs.length = 0;\n\t\tconst names = anode['_names'];\n\t\tnames.length = 0;\n\t\tfor (let i = 0; i < json.length; i++) {\n\t\t\tconst item = json[i];\n\t\t\tnames.push(item.name);\n\t\t\tconst encoded = file.base64ToArrayBuffer(item.data);\n\t\t\tencs.push(encoded);\n\t\t\tthis.decodeBuffer(anode, encoded, bufs, i);\n\t\t}\n\t}\n\n\tdecodeBuffer(anode, data, bufs, i) {\n\t\tanode.context.decodeAudioData(data, buffer => bufs[i] = buffer);\n\t}\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/synth.ts\n **/","import { NodeData } from './synth';\nimport { ADSR } from './customNodes';\nimport { ModernAudioNode, removeArrayElement } from '../utils/modern';\n\n\n/**\n * A note handler handles MIDI keyboard events on behalf of a synth node,\n * updating the node status accordingly.\n */\nexport interface NoteHandler {\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void;\n\tnoteOff(midi: number, gain: number, when: number): void;\n\tkbTrigger: boolean;\n\treleaseTime: number;\n}\n\n/**\n * Handles common AudioNode cloning, used by oscillator and buffered data nodes.\n */\nclass BaseNoteHandler implements NoteHandler {\n\tndata: NodeData;\n\toutTracker: OutputTracker;\n\tkbTrigger = false;\n\treleaseTime = 0;\n\n\tconstructor(ndata: NodeData) {\n\t\tthis.ndata = ndata;\n\t\tthis.outTracker = new OutputTracker(ndata.anode);\n\t}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {}\n\tnoteOff(midi: number, gain: number, when: number): void {}\n\n\tclone(): AudioNode {\n\t\t// Create clone\n\t\tconst anode = this.ndata.anode.context[this.ndata.nodeDef.constructor]();\n\t\t// Copy parameters\n\t\tfor (const pname of Object.keys(this.ndata.nodeDef.params)) {\n\t\t\tconst param = this.ndata.anode[pname];\n\t\t\tif (param instanceof AudioParam)\n\t\t\t\tanode[pname].value = param.value;\n\t\t\telse if (param !== null && param !== undefined)\n\t\t\t\tanode[pname] = param;\n\t\t}\n\t\t// Copy output connections\n\t\tfor (const out of this.outTracker.outputs) {\n\t\t\tlet o2: any = out;\n\t\t\tif (o2.custom && o2.anode) o2 = o2.anode;\n\t\t\tanode.connect(o2);\n\t\t}\n\t\t// Copy control input connections\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.connect(anode[inData.controlParam]);\n\t\t}\n\t\t//TODO should copy snapshot of list of inputs and outputs\n\t\t//...in case user connects or disconnects during playback\n\t\treturn anode;\n\t}\n\n\tdisconnect(anode: ModernAudioNode): void {\n\t\t// Disconnect outputs\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tanode.disconnect(out);\n\t\t// Disconnect control inputs\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.disconnect(anode[inData.controlParam]);\n\t\t}\n\t}\n\n\trampParam(param: MAudioParam, ratio: number, when: number): void {\n\t\tconst portamento = this.ndata.synth.portamento;\n\t\tconst newv = param.value * ratio;\n\t\tparam._value = newv;\t// Required for ADSR to capture the correct value\n\t\tif (portamento.time > 0 && portamento.ratio > 0) {\n\t\t\tconst oldv = param.value * portamento.ratio;\n\t\t\tparam.cancelScheduledValues(when);\n\t\t\tparam.linearRampToValueAtTime(oldv, when);\n\t\t\tparam.exponentialRampToValueAtTime(newv, when + portamento.time);\n\t\t}\n\t\telse param.setValueAtTime(newv, when);\n\t}\n}\n\n/**\n * Handles note events for an OscillatorNode\n */\nclass OscNoteHandler extends BaseNoteHandler {\n\toscClone: OscillatorNode;\n\tlastNote: number;\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {\n\t\tif (this.oscClone) this.oscClone.stop(when);\n\t\tthis.oscClone = <OscillatorNode>this.clone();\n\t\tthis.rampParam(<MAudioParam>this.oscClone.frequency, ratio, when);\n\t\tthis.oscClone.start(when);\n\t\tthis.lastNote = midi;\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return;\t// Avoid multple keys artifacts in mono mode\n\t\tthis.oscClone.stop(when + this.releaseTime);\n\t}\n}\n\n/**\n * Handles note events for an LFO node. This is identical to a regular\n * oscillator node, but the note does not affect the oscillator frequency\n */\nclass LFONoteHandler extends OscNoteHandler {\n\trampParam(param: AudioParam, ratio: number, when: number) {\n\t\t// Disable portamento for LFO\n\t\tparam.setValueAtTime(param.value, when);\n\t}\n}\n\n/**\n * Handles note events for an AudioBufferSourceNode\n */\nclass BufferNoteHandler extends BaseNoteHandler {\n\tabsn: AudioBufferSourceNode;\n\tlastNote: number;\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {\n\t\tif (this.absn)\n\t\t\tthis.absn.stop(when);\n\t\tconst buf = this.ndata.anode['_buffer'];\n\t\tif (!buf) return;\t// Buffer still loading or failed\n\t\tthis.absn = <AudioBufferSourceNode>this.clone();\n\t\tthis.absn.buffer = buf;\n\t\tconst pbr = this.absn.playbackRate;\n\t\tconst newRate = pbr.value * ratio;\n\t\tthis.rampParam(<MAudioParam>pbr, pbr.value * ratio, when);\n\t\tthis.absn.start(when);\n\t\tthis.lastNote = midi;\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return;\n\t\tthis.absn.stop(when + this.releaseTime);\n\t}\n}\n\n/**\n * Performs computations about ramps so they can be easily rescheduled\n */\nclass Ramp {\n\tconstructor(public v1: number, public v2: number, public t1: number, public t2: number) {}\n\tinside(t: number) {\n\t\treturn this.t1 < this.t2 && this.t1 <= t && t <= this.t2;\n\t}\n\tcut(t: number) {\n\t\tconst newv = this.v1 + (this.v2 - this.v1) * (t - this.t1) / (this.t2 - this.t1);\n\t\treturn new Ramp(this.v1, newv, this.t1, t);\n\t}\n\trun(p: AudioParam, follow: boolean = false) {\n\t\tif (this.t2 - this.t1 <= 0) {\n\t\t\tp.setValueAtTime(this.v2, this.t2);\n\t\t}\n\t\telse {\n\t\t\tif (!follow) p.setValueAtTime(this.v1, this.t1);\n\t\t\tp.linearRampToValueAtTime(this.v2, this.t2);\n\t\t}\n\t}\n}\n\ninterface MAudioParam extends AudioParam {\n\t_attack: Ramp;\n\t_decay: Ramp;\n\t_release: Ramp;\n\t_value: number;\n}\n/**\n * Handles note events for a custom ADSR node\n */\nclass ADSRNoteHandler extends BaseNoteHandler {\n\tlastNote: number;\n\tkbTrigger = true;\n\n\tconstructor(ndata: NodeData) {\n\t\tsuper(ndata);\n\t\tconst adsr: ADSR = <ADSR>ndata.anode;\n\t\tconst oldMethod = adsr.disconnect;\n\t\tadsr.disconnect = (dest: AudioParam) => {\n\t\t\tthis.loopParams(param => {\n\t\t\t\tif (param == dest)\n\t\t\t\t\tparam.setValueAtTime(param._value, adsr.context.currentTime);\n\t\t\t});\n\t\t\toldMethod(dest);\n\t\t}\n\t}\n\n\tget releaseTime() {\n\t\tconst adsr: ADSR = <ADSR>this.ndata.anode;\n\t\treturn adsr.release;\n\t}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {\n\t\tthis.lastNote = midi;\n\t\tconst adsr: ADSR = <ADSR>this.ndata.anode;\n\t\tthis.loopParams(param => {\n\t\t\tconst v = this.getParamValue(param);\n\t\t\tconst initial = (1 - adsr.depth) * v;\n\t\t\tconst sustain = v * adsr.sustain + initial * (1 - adsr.sustain);\n\t\t\tconst now = adsr.context.currentTime;\n\t\t\tparam.cancelScheduledValues(now);\n\t\t\tif (when > now)\n\t\t\t\tthis.rescheduleRamp(param, param._release, now);\n\t\t\tparam._attack = new Ramp(initial, v, when, when + adsr.attack);\n\t\t\tparam._decay = new Ramp(v, sustain, when + adsr.attack, when + adsr.attack + adsr.decay);\n\t\t\tparam._attack.run(param);\n\t\t\tparam._decay.run(param, true);\n\t\t});\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return;\t// Avoid multple keys artifacts in mono mode\n\t\tconst adsr: ADSR = <ADSR>this.ndata.anode;\n\t\tthis.loopParams(param => {\n\t\t\tlet v = this.getRampValueAtTime(param, when);\n\t\t\tif (v === null)\n\t\t\t\tv = this.getParamValue(param) * adsr.sustain;\n\t\t\tconst finalv = (1 - adsr.depth) * v;\n\t\t\tparam.cancelScheduledValues(when);\n\t\t\tconst now = adsr.context.currentTime;\n\t\t\tif (when > now)\n\t\t\t\tthis.rescheduleRamp(param, param._attack, now) ||\n\t\t\t\tthis.rescheduleRamp(param, param._decay, now);\n\t\t\tparam._release = new Ramp(v, finalv, when, when + adsr.release);\n\t\t\tparam._release.run(param);\n\t\t});\n\t}\n\n\trescheduleRamp(param: MAudioParam, ramp: Ramp, now: number): boolean {\n\t\tif (ramp && ramp.inside(now)) {\n\t\t\tramp.cut(now).run(param);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetRampValueAtTime(param: MAudioParam, t: number): number {\n\t\tlet ramp;\n\t\tif (param._attack && param._attack.inside(t))\n\t\t\treturn param._attack.cut(t).v2;\n\t\tif (param._decay && param._decay.inside(t))\n\t\t\treturn param._decay.cut(t).v2;\n\t\treturn null;\n\t}\n\n\tloopParams(cb: (out: MAudioParam) => void): void {\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tif (out instanceof AudioParam)\n\t\t\t\tcb(<MAudioParam>out);\n\t}\n\n\tgetParamValue(p: MAudioParam): number {\n\t\tif (p._value === undefined) p._value = p.value;\n\t\treturn p._value;\n\t}\n}\n\n/**\n * Handles note events for any node that allows calling start() after stop(),\n * such as custom nodes.\n */\nclass RestartableNoteHandler extends BaseNoteHandler {\n\tlastNote: number;\n\tplaying = false;\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {\n\t\tconst anode: any = this.ndata.anode;\n\t\tif (this.playing)\n\t\t\tanode.stop(when);\n\t\tthis.playing = true;\n\t\tanode.start(when);\n\t\tthis.lastNote = midi;\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return;\n\t\tthis.playing = false;\n\t\tconst anode: any = this.ndata.anode;\n\t\tanode.stop(when + this.releaseTime);\n\t}\n}\n\n/**\n * Handles note events for the SoundBank source node\n */\nclass SoundBankNoteHandler extends BaseNoteHandler {\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number):void {\n\t\tconst bufs = this.ndata.anode['_buffers'];\n\t\tconst absn = <AudioBufferSourceNode>this.clone();\n\t\tabsn.buffer = bufs[midi % bufs.length];\n\t\tabsn.start(when);\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {}\n}\n\n//-------------------- Exported note handlers --------------------\n\n/**\n * Exports available note handlers so they are used by their respective\n * nodes from the palette.\n */\nexport const NoteHandlers = {\n\t'osc': OscNoteHandler,\n\t'buffer': BufferNoteHandler,\n\t'ADSR': ADSRNoteHandler,\n\t'LFO': LFONoteHandler,\n\t'restartable': RestartableNoteHandler,\n\t'soundBank': SoundBankNoteHandler\n};\n\n\n//-------------------- Private classes --------------------\n\n/**\n * Tracks a node output connections and disconnections, to be used\n * when cloning, removing or controlling nodes.\n */\nclass OutputTracker {\n\toutputs: (AudioNode | AudioParam) [] = [];\n\n\tconstructor(anode: AudioNode) {\n\t\tthis.onBefore(anode, 'connect', this.connect, (oldf, obj, args) => {\n\t\t\tif (args[0].custom && args[0].anode) args[0] = args[0].anode;\n\t\t\toldf.apply(obj, args);\n\t\t});\n\t\tthis.onBefore(anode, 'disconnect', this.disconnect);\n\t}\n\n\tconnect(np) {\n\t\tthis.outputs.push(np);\n\t}\n\n\tdisconnect(np) {\n\t\tremoveArrayElement(this.outputs, np);\n\t}\n\n\tonBefore(obj: any, fname: string, funcToCall: Function, cb?: (oldf, obj, args) => void): void {\n\t\tconst oldf = obj[fname];\n\t\tconst self = this;\n\t\tobj[fname] = function() {\n\t\t\tfuncToCall.apply(self, arguments);\n\t\t\tif (cb) cb(oldf, obj, arguments)\n\t\t\telse oldf.apply(obj, arguments);\n\t\t}\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/notes.ts\n **/","/**\n * Modernize browser interfaces so that TypeScript does not complain\n * when using new features.\n *\n * Also provides some basic utility funcitons\n */\n\nexport interface ModernWindow extends Window {\n\tAudioContext: AudioContext;\n\twebkitAudioContext: AudioContext;\n}\n\nexport interface ModernAudioContext extends AudioContext {\n\tsuspend: () => void;\n\tresume: () => void;\n}\n\nexport interface ModernAudioNode extends AudioNode {\n\tdisconnect(output?: number | AudioNode | AudioParam): void\n}\n\n\nexport function removeArrayElement(a: any[], e: any): boolean {\n\tconst pos = a.indexOf(e);\n\tif (pos < 0) return false;\t// not found\n\ta.splice(pos, 1);\n\treturn true;\n}\n\nconst LOG_BASE = 2;\n\nfunction logarithm(base: number, x: number): number {\n\treturn Math.log(x) / Math.log(base);\n}\n\nexport function linear2log(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min);\n\treturn logarithm(LOG_BASE, value + 1 - min) / logRange;\n}\n\nexport function log2linear(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min);\n\treturn min + Math.pow(LOG_BASE, value * logRange) - 1;\n}\n\nexport function focusable(elem) {\n\twhile (elem.tabIndex < 0 && elem.nodeName.toLowerCase() != 'body')\n\t\telem = elem.parentElement;\n\treturn elem;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/utils/modern.ts\n **/","/** Configuration data for an AudioNode parameter */\nexport interface NodeParamDef {\n\tinitial: any;\n\tmin?: number;\n\tmax?: number;\n\tlinear?: boolean;\n\tchoices?: string[];\n\thandler?: string;\n\tphandler?: any;\n}\n\n/** Configuration data for an AudioNode */\nexport interface NodeDef {\n\tconstructor: string;\n\tcustom?: boolean;\n\tnoteHandler?: string;\n\tcontrol?: boolean;\n\tparams: { [key: string]: NodeParamDef };\n}\n\n/** A set of AudioNode configuration elements */\nexport interface NodePalette {\n\t[key: string]: NodeDef;\n}\n\n//-------------------- Node palette definition --------------------\n\nconst OCTAVE_DETUNE: NodeParamDef = {\n\tinitial: 0,\n\tmin: -1200,\n\tmax: 1200,\n\tlinear: true\n};\n\n/**\n * The set of AudioNodes available to the application, along with\n * their configuration.\n */\nexport var palette: NodePalette = {\n\t// Sources\n\tOscillator: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'osc',\n\t\tparams: {\n\t\t\tfrequency: { initial: 220, min: 20, max: 20000 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sawtooth',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tBuffer: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'buffer',\n\t\tparams: {\n\t\t\tplaybackRate: { initial: 1, min: 0, max: 8 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'BufferDataHandler'\n\t\t\t},\n\t\t\tloop: { initial: false },\n\t\t\tloopStart: { initial: 0, min: 0, max: 10 },\n\t\t\tloopEnd: { initial: 3, min: 0, max: 10 }\n\t\t}\n\t},\n\tNoise: {\n\t\tconstructor: 'createNoise',\n\t\tnoteHandler: 'restartable',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tgain:  { initial: 1, min: 0, max: 10 }\n\t\t}\n\t},\n\tLineIn: {\n\t\tconstructor: 'createLineIn',\n\t\tcustom: true,\n\t\tparams: {}\n\t},\n\tSoundBank: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'soundBank',\n\t\tparams: {\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'SoundBankHandler'\n\t\t\t}\n\t\t}\t\n\t},\n\t// Effects\n\tGain: {\n\t\tconstructor: 'createGain',\n\t\tparams: {\n\t\t\tgain: { initial: 1, min: 0, max: 10, linear: true }\n\t\t}\n\t},\n\tFilter: {\n\t\tconstructor: 'createBiquadFilter',\n\t\tparams: {\n\t\t\tfrequency: { initial: 440, min: 20, max: 20000 },\n\t\t\tQ: { initial: 0, min: 0, max: 100 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tgain: { initial: 0, min: -40, max: 40, linear: true },\n\t\t\ttype: {\n\t\t\t\tinitial: 'lowpass',\n\t\t\t\tchoices: ['lowpass', 'highpass', 'bandpass',\n\t\t\t\t\t'lowshelf', 'highshelf', 'peaking', 'notch', 'allpass']\n\t\t\t}\n\t\t},\n\t},\n\tDelay: {\n\t\tconstructor: 'createDelay',\n\t\tparams: {\n\t\t\tdelayTime: { initial: 1, min: 0, max: 5 }\n\t\t}\n\t},\n\tStereoPan: {\n\t\tconstructor: 'createStereoPanner',\n\t\tparams: {\n\t\t\tpan: { initial: 0, min: -1, max: 1, linear: true }\n\t\t}\n\t},\n\tCompressor: {\n\t\tconstructor: 'createDynamicsCompressor',\n\t\tparams: {\n\t\t\tthreshold: { initial: -24, min: -100, max: 0, linear: true },\n\t\t\tknee: { initial: 30, min: 0, max: 40, linear: true },\n\t\t\tratio: { initial: 12, min: 1, max: 20, linear: true },\n\t\t\treduction: { initial: 0, min: -20, max: 0, linear: true },\n\t\t\tattack: { initial: 0.003, min: 0, max: 1 },\n\t\t\trelease: { initial: 0.25, min: 0, max: 1 }\n\t\t}\n\t},\n\tDetuner: {\n\t\tconstructor: 'createDetuner',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\toctave: { initial: 0, min: -2, max: 2, linear: true }\n\t\t}\n\t},\n\t// Controllers\n\tLFO: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'LFO',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 5, min: 0.01, max: 200 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sine',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tGainCtrl: {\n\t\tconstructor: 'createGain',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tgain: { initial: 10, min: 0, max: 100, linear: true }\n\t\t}\n\t},\n\tADSR: {\n\t\tconstructor: 'createADSR',\n\t\tnoteHandler: 'ADSR',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tattack:  { initial: 0.2, min: 0, max: 10 },\n\t\t\tdecay:   { initial: 0.5, min: 0, max: 10 },\n\t\t\tsustain: { initial: 0.5, min: 0, max: 1, linear: true },\n\t\t\trelease: { initial: 1.0, min: 0, max: 10 },\n\t\t\tdepth:   { initial: 1.0, min: 0, max: 1 }\n\t\t}\n\t},\n\tNoiseCtrl: {\n\t\tconstructor: 'createNoiseCtrl',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 4, min: 0, max: 200 },\n\t\t\tdepth:  { initial: 20, min: 0, max: 200 }\n\t\t}\n\t},\n\t// Output\n\tSpeaker: {\n\t\tconstructor: null,\n\t\tparams: {}\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/palette.ts\n **/","import { ModernAudioContext, ModernAudioNode } from '../utils/modern';\n\n/**\n * Base class to derive all custom nodes from it\n */\nclass CustomNodeBase implements ModernAudioNode {\n\tcustom = true;\n\tchannelCount = 2;\n\tchannelCountMode = 'max';\n\tchannelInterpretation = 'speakers';\n\tcontext: AudioContext;\n\tnumberOfInputs = 0;\n\tnumberOfOutputs = 1;\n\tconnect(param: AudioParam | AudioNode) {}\n\tdisconnect(dest: AudioNode | AudioParam) {}\n\t// Required for extending EventTarget\n\taddEventListener(){}\n\tdispatchEvent(evt: Event): boolean { return false; }\n\tremoveEventListener(){}\n}\n\n\n/**\n * Envelope generator that controls the evolution over time of a destination\n * node's parameter. All parameter control is performed in the corresponding\n * ADSR note handler.\n */\nexport class ADSR extends CustomNodeBase {\n\tattack: number = 0.2;\n\tdecay: number = 0.5;\n\tsustain: number = 0.5;\n\trelease: number = 1;\n\tdepth: number = 1;\n\t//TODO linear / exponential\n}\n\n\n/**\n * Base ScriptProcessor, to derive all custom audio processing nodes from it.\n */\nclass ScriptProcessor extends CustomNodeBase {\n\tgain: number = 1;\n\tanode: ScriptProcessorNode;\n\tplaying: boolean = false;\n\n\tconstructor(ac: AudioContext) {\n\t\tsuper();\n\t\tthis.anode = ac.createScriptProcessor(1024);\n\t\tthis.anode.onaudioprocess = evt => this.processAudio(evt);\n\t}\n\n\tconnect(node: AudioNode) {\n\t\tthis.anode.connect(node);\n\t}\n\n\tdisconnect() {\n\t\tthis.anode.disconnect();\n\t}\n\n\tstart() {\n\t\tthis.playing = true;\n\t}\n\n\tstop() {\n\t\tthis.playing = false;\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {}\n}\n\n\n/**\n * Simple noise generator\n */\nexport class NoiseGenerator extends ScriptProcessor {\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tconst out = evt.outputBuffer.getChannelData(channel);\n\t\t\tfor (let sample = 0; sample < out.length; sample++)\n\t\t\t\tout[sample] = this.playing ? this.gain * (Math.random() * 2 - 1) : 0;\n\t\t}\n\t}\n}\n\n\n/**\n * Noise generator to be used as control node.\n * It uses sample & hold in order to implement the 'frequency' parameter.\n */\nexport class NoiseCtrlGenerator extends ScriptProcessor {\n\tac: ModernAudioContext;\n\tfrequency: number;\n\tdepth: number;\n\tsct: number;\n\tv: number;\n\n\tconstructor(ac: ModernAudioContext) {\n\t\tsuper(ac);\n\t\tthis.ac = ac;\n\t\tthis.frequency = 4;\n\t\tthis.depth = 20;\n\t\tthis.sct = 0;\n\t\tthis.v = 0;\n\t}\n\n\tconnect(param: any) {\n\t\tthis.anode.connect(param);\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst samplesPerCycle = this.ac.sampleRate / this.frequency;\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel);\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tthis.sct++;\n\t\t\t\tif (this.sct > samplesPerCycle) {\n\t\t\t\t\tthis.v = this.depth * (Math.random() * 2 - 1);\n\t\t\t\t\tthis.sct = 0; //this.sct - Math.floor(this.sct);\n\t\t\t\t}\n\t\t\t\tout[sample] = this.v;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Simple Pitch Shifter implemented in a quick & dirty way\n */\nexport class Detuner extends ScriptProcessor {\n\toctave: number = 0;\n\tnumberOfInputs = 1;\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst dx = Math.pow(2, this.octave);\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel);\n\t\t\tlet inbuf = evt.inputBuffer.getChannelData(channel);\n\t\t\tlet sct = 0;\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tout[sample] = inbuf[Math.floor(sct)];\n\t\t\t\tsct += dx;\n\t\t\t\tif (sct >= inbuf.length) sct = 0;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Captures audio from the PC audio input.\n * Requires user's authorization to grab audio input.\n */\nexport class LineInNode extends CustomNodeBase {\n\tsrcNode: ModernAudioNode;\n\tdstNode: ModernAudioNode;\n\tstream: any;\n\n\tconnect(anode: AudioNode) {\n\t\tif (this.srcNode) {\n\t\t\tthis.srcNode.connect(anode);\n\t\t\tthis.dstNode = anode;\n\t\t\treturn;\n\t\t}\n\t\tconst navigator: any = window.navigator;\n\t\tnavigator.getUserMedia = (navigator.getUserMedia ||\n\t\t\tnavigator.webkitGetUserMedia ||\n\t\t\tnavigator.mozGetUserMedia ||\n\t\t\tnavigator.msGetUserMedia);\n\t\tnavigator.getUserMedia({ audio: true }, stream => {\n\t\t\tconst ac: any = anode.context;\n\t\t\tthis.srcNode = ac.createMediaStreamSource(stream);\n\t\t\tlet a2: any = anode;\n\t\t\tif (a2.custom && a2.anode) a2 = a2.anode;\n\t\t\tthis.srcNode.connect(a2);\n\t\t\tthis.dstNode = anode;\n\t\t\tthis.stream = stream;\n\t\t}, error => console.error(error));\n\t}\n\n\tdisconnect() {\n\t\tthis.srcNode.disconnect(this.dstNode);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/customNodes.ts\n **/","//-------------------- Encoding / decoding --------------------\n\nexport function arrayBufferToBase64(buffer) {\n\tvar binary = '';\n\tvar bytes = new Uint8Array(buffer);\n\tvar len = bytes.byteLength;\n\tfor (var i = 0; i < len; i++) {\n\t\tbinary += String.fromCharCode(bytes[i]);\n\t}\n\treturn window.btoa(binary);\n}\n\nexport function base64ToArrayBuffer(base64) {\n\tvar binary_string = window.atob(base64);\n\tvar len = binary_string.length;\n\tvar bytes = new Uint8Array(len);\n\tfor (var i = 0; i < len; i++) {\n\t\tbytes[i] = binary_string.charCodeAt(i);\n\t}\n\treturn bytes.buffer;\n}\n\n\n//-------------------- Downloading --------------------\n\nexport function browserSupportsDownload(): boolean {\n\treturn !(<any>window).externalHost && 'download' in $('<a>')[0];\n}\n\nexport function download(fileName, fileData) {\n\tconst a = $('<a>');\n\ta.attr('download', fileName);\n\ta.attr('href',\n\t\t'data:application/octet-stream;base64,' + btoa(fileData));\n\tconst clickEvent = new MouseEvent('click',\n\t\t{ view: window, bubbles: true, cancelable: false });\n\ta[0].dispatchEvent(clickEvent);\n}\n\n\n//-------------------- Uploading --------------------\n\nexport function uploadText(event, cb: (text, file) => void) {\n\tupload(event, cb, 'readAsText');\n}\n\nexport function uploadArrayBuffer(event, cb: (ab, file) => void) {\n\tupload(event, cb, 'readAsArrayBuffer');\n}\n\nfunction upload(event, cb, readFunc: string) {\n\tif (!event.target.files || event.target.files.length <= 0) return cb(null);\n\tconst file = event.target.files[0];\n\tconst reader = new FileReader();\n\treader.onload = (loadEvt: any)  => cb(loadEvt.target.result, file);\n\treader[readFunc](file);\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/utils/file.ts\n **/","interface TimerCallback {\n\t(time: number): void;\n}\n\nexport class Timer {\n\trunning: boolean;\n\tac: AudioContext;\n\tcb: TimerCallback;\n\t_bpm: number;\n\tahead: number;\n\tnextNoteTime: number;\n\tnoteDuration: number;\n\n\tconstructor(ac: AudioContext, bpm = 60, ahead = 0.1) {\n\t\tthis.running = false;\n\t\tthis.ac = ac;\n\t\tthis.noteDuration = 0;\n\t\tthis.nextNoteTime = 0;\n\t\tthis.bpm = bpm;\n\t\tthis.ahead = ahead;\n\t}\n\n\tget bpm() { return this._bpm; }\n\n\tset bpm(v) {\n\t\tthis._bpm = v;\n\t\tthis.nextNoteTime -= this.noteDuration;\n\t\tthis.noteDuration = (1/4) * 60 / this._bpm;\n\t\tthis.nextNoteTime += this.noteDuration;\n\t}\n\n\tstart(cb?: TimerCallback): void {\n\t\tif (this.running) return;\n\t\tthis.running = true;\n\t\tif (cb) this.cb = cb;\n\t\tthis.nextNoteTime = this.ac.currentTime;\n\t\tthis.tick();\n\t}\n\n\tstop(): void {\n\t\tthis.running = false;\n\t}\n\n\ttick(): void {\n\t\tif (!this.running) return;\n\t\trequestAnimationFrame(this.tick.bind(this));\n\t\twhile (this.nextNoteTime < this.ac.currentTime + this.ahead) {\n\t\t\tif (this.cb) this.cb(this.nextNoteTime);\n\t\t\tthis.nextNoteTime += this.noteDuration;\n\t\t}\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/timer.ts\n **/","import { ModernAudioContext } from '../utils/modern';\nimport { Synth, NodeData, Portamento } from './synth';\n\n\n/**\n * A polyphonic synth controlling an array of voices\n */\nexport class Instrument {\n\tvoices: Voice[];\n\tpressed: number[];\n\treleased: number[];\n\tportamento: Portamento;\n\n\tconstructor(ac: ModernAudioContext, json: any, numVoices: number, dest?: AudioNode) {\n\t\t// Setup voices\n\t\tthis.pressed = [];\n\t\tthis.released = [];\n\t\tthis.voices = [];\n\t\tfor (let i = 0; i < numVoices; i++) {\n\t\t\tthis.voices.push(new Voice(ac, json, dest));\n\t\t\tthis.released.push(i);\n\t\t}\n\t\t// Setup synth params by having a common instance for all voices\n\t\tthis.portamento = this.voices[0].synth.portamento;\n\t\tif (json.keyboard && json.keyboard.portamento)\n\t\t\tthis.portamento.time = json.keyboard.portamento;\n\t\tfor (let i = 1; i < numVoices; i++)\n\t\t\tthis.voices[i].synth.portamento = this.portamento;\n\t}\n\n\tnoteOn(midi: number, velocity: number = 1, when?: number): void {\n\t\tconst vnum = this.findVoice();\n\t\tconst voice = this.voices[vnum];\n\t\tthis.pressed.push(vnum);\n\t\tvoice.noteOn(midi, velocity, when);\n\t}\n\n\tnoteOff(midi: number, velocity: number = 1, when?: number): void {\n\t\tfor (let i = 0; i < this.voices.length; i++) {\n\t\t\tconst voice = this.voices[i];\n\t\t\tif (voice.lastNote == midi) {\n\t\t\t\tvoice.noteOff(midi, velocity, when);\n\t\t\t\tthis.released.push(i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tallNotesOff() {\n\t\tfor (const voice of this.voices) {\n\t\t\tif (voice.lastNote) voice.noteOff(voice.lastNote);\n\t\t}\n\t}\n\n\tfindVoice(): number {\n\t\tlet voices: number[];\n\t\tif (this.released.length > 0) voices = this.released;\n\t\telse if (this.pressed.length > 0) voices = this.pressed;\n\t\telse throw \"This should never happen\";\n\t\treturn voices.splice(0, 1)[0];\n\t}\n\n\tclose() {\n\t\tfor (const voice of this.voices) voice.close();\n\t}\n}\n\n\n/**\n * An independent monophonic synth\n */\nexport class Voice {\n\tsynth: Synth;\n\tlastNote: number;\n\tloader: SynthLoader;\n\n\tconstructor(ac: ModernAudioContext, json: any, dest?: AudioNode) {\n\t\tthis.loader = new SynthLoader();\n\t\tthis.synth = this.loader.load(ac, json, dest || ac.destination);\n\t\tthis.lastNote = 0;\n\t}\n\n\tnoteOn(midi: number, velocity: number = 1, when?: number): void {\n\t\tthis.synth.noteOn(midi, velocity, when);\n\t\tthis.lastNote = midi;\n\t}\n\n\tnoteOff(midi: number, velocity: number = 1, when?: number): void {\n\t\tthis.synth.noteOff(midi, velocity, when);\n\t\tthis.lastNote = 0;\n\t}\n\n\tclose(): void {\n\t\t// This method must be called to avoid memory leaks at the Web Audio level\n\t\tif (this.lastNote) this.noteOff(this.lastNote, 1);\n\t\tthis.loader.close();\n\t}\n}\n\n\n//-------------------- Private --------------------\n\nclass VoiceNodeData extends NodeData {\n\tinputs: NodeData[] = [];\n\tconstructor(public id: number) {\n\t\tsuper();\n\t}\n\tgetInputs(): NodeData[] {\n\t\treturn this.inputs;\n\t}\n}\n\nclass SynthLoader {\n\tnodes: VoiceNodeData[] = [];\n\tsynth: Synth;\n\n\tload(ac: ModernAudioContext, json: any, dest: AudioNode): Synth {\n\t\tconst synth = new Synth(ac);\n\t\t// Add nodes into id-based table\n\t\tlet i = 0;\n\t\tfor (const jn of json.nodes)\n\t\t\tthis.nodes[i++] = new VoiceNodeData(jn.id);\n\t\t// Then set their list of inputs\n\t\tfor (let i = 0; i < json.nodes.length; i++)\n\t\t\tfor (const inum of json.nodes[i].inputs)\n\t\t\t\tthis.nodes[i].inputs.push(this.nodeById(inum));\n\t\t// Then set their data\n\t\tfor (let i = 0; i < json.nodes.length; i++) {\n\t\t\tconst type = json.nodeData[i].type;\n\t\t\tif (type == 'out')\n\t\t\t\tsynth.initOutputNodeData(this.nodes[i], dest);\n\t\t\telse\n\t\t\t\tsynth.initNodeData(this.nodes[i], type);\n\t\t\tsynth.json2NodeData(json.nodeData[i], this.nodes[i]);\n\t\t}\n\t\t// Then notify connections to handler\n\t\tfor (const dst of this.nodes)\n\t\t\tfor (const src of dst.inputs)\n\t\t\t\tsynth.connectNodes(src, dst);\n\t\t// Finally, return the newly created synth\n\t\tthis.synth = synth;\n\t\treturn synth;\n\t}\n\n\tnodeById(id: number): VoiceNodeData {\n\t\tfor (const node of this.nodes)\n\t\t\tif (node.id === id) return node;\n\t\treturn null;\n\t}\n\n\tclose() {\n\t\tfor (const node of this.nodes)\n\t\t\tfor (const input of node.inputs)\n\t\t\t\tthis.synth.disconnectNodes(input, node);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/synth/instrument.ts\n **/"],"sourceRoot":""}